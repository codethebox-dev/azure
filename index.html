<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>codethebox.dev — Cloud & Tech Certifications</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=Syne:wght@700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
/* ════════════════════════════════════════════════
   THEME TOKENS
════════════════════════════════════════════════ */
[data-theme="light"] {
  --bg0:    #F0F4FA;
  --bg1:    #FFFFFF;
  --bg2:    #F7F9FC;
  --bg3:    #EDF1F8;
  --bg4:    #DDE3EF;
  --border: rgba(0,0,0,0.08);
  --border2:rgba(0,0,0,0.14);
  --text:   #0F172A;
  --text2:  #475569;
  --text3:  #94A3B8;
  --shadow: 0 2px 8px rgba(0,0,0,0.07), 0 1px 2px rgba(0,0,0,0.05);
  --shadow-lg: 0 8px 32px rgba(0,0,0,0.1);
  --hdr-bg: rgba(255,255,255,0.92);
  --scanline: none;
  --card-hover-shadow: 0 12px 40px rgba(0,0,0,0.12);
}
[data-theme="dark"] {
  --bg0:    #070B14;
  --bg1:    #0C1220;
  --bg2:    #111827;
  --bg3:    #1A2235;
  --bg4:    #1E2A3E;
  --border: rgba(255,255,255,0.08);
  --border2:rgba(255,255,255,0.14);
  --text:   #E8EDF5;
  --text2:  #94A3B8;
  --text3:  #64748B;
  --shadow: 0 2px 8px rgba(0,0,0,0.3);
  --shadow-lg: 0 8px 32px rgba(0,0,0,0.5);
  --hdr-bg: rgba(7,11,20,0.92);
  --scanline: repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,0,0,0.015) 2px,rgba(0,0,0,0.015) 4px);
  --card-hover-shadow: 0 8px 32px rgba(0,0,0,0.4);
}

:root {
  --accent:  #0066FF;
  --accent2: #004DCC;
  --green:   #10B981;
  --amber:   #F59E0B;
  --rose:    #F43F5E;
  --violet:  #8B5CF6;
  --aws:     #FF9900;
  --gcp:     #4285F4;
  --azure:   #0078D4;
  --m365:    #D83B01;
  --comptia: #C8202A;
  --k8s:     #326CE5;
  --linux:   #FCC624;
  --fund:    #3B82F6;
  --assoc:   #10B981;
  --pro:     #8B5CF6;
  --expert:  #F43F5E;
  --spec:    #F59E0B;
  --sidebar-w: 300px;
  --hdr-h:     62px;
  --r:   8px;
  --r-lg:14px;
}

*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}
body{
  font-family:'Plus Jakarta Sans',sans-serif;
  background:var(--bg0);color:var(--text);
  font-size:14px;line-height:1.7;
  overflow-x:hidden;min-height:100vh;
  transition:background 0.3s,color 0.3s;
}
body::before{
  content:'';position:fixed;inset:0;
  background:var(--scanline);
  pointer-events:none;z-index:9999;
}
::-webkit-scrollbar{width:5px;height:5px}
::-webkit-scrollbar-track{background:var(--bg1)}
::-webkit-scrollbar-thumb{background:var(--bg4);border-radius:3px}
::-webkit-scrollbar-thumb:hover{background:var(--accent)}
a{color:inherit;text-decoration:none}
button{font-family:'Plus Jakarta Sans',sans-serif}

/* ════ HEADER ════ */
header{
  position:fixed;top:0;left:0;right:0;
  height:var(--hdr-h);
  background:var(--hdr-bg);
  backdrop-filter:blur(16px);
  border-bottom:1px solid var(--border);
  display:flex;align-items:center;
  padding:0 24px;gap:12px;z-index:500;
  transition:background 0.3s;
}
.logo-wrap{display:flex;align-items:center;gap:10px;cursor:pointer;flex-shrink:0}
.logo-mark{
  width:38px;height:38px;
  background:linear-gradient(135deg,var(--accent),#0033AA);
  border-radius:11px;display:flex;align-items:center;justify-content:center;
  box-shadow:0 0 16px rgba(0,102,255,0.35);
}
.logo-mark svg{width:20px;height:20px}
.logo-text{
  font-family:'JetBrains Mono',monospace;
  font-size:15px;font-weight:600;letter-spacing:-0.01em;
}
.logo-tld{color:var(--text3)}
.hdr-div{width:1px;height:22px;background:var(--border);flex-shrink:0}
.hdr-nav{display:flex;align-items:center;gap:4px}
.hdr-btn{
  padding:6px 14px;border-radius:7px;
  background:none;border:none;
  font-size:13.5px;font-weight:600;color:var(--text2);
  cursor:pointer;transition:all 0.15s;
}
.hdr-btn:hover{color:var(--text);background:var(--bg3)}
.hdr-btn.active{color:var(--accent);background:rgba(0,102,255,0.08)}
.hdr-right{display:flex;align-items:center;gap:10px;margin-left:auto}

/* Search */
.hdr-search{
  display:flex;align-items:center;gap:7px;
  background:var(--bg2);border:1px solid var(--border);
  border-radius:8px;padding:0 12px;
  transition:border-color 0.2s,box-shadow 0.2s;
}
.hdr-search:focus-within{border-color:var(--accent);box-shadow:0 0 0 3px rgba(0,102,255,0.1)}
.hdr-search input{
  background:none;border:none;outline:none;
  color:var(--text);font-family:inherit;
  font-size:13px;width:180px;padding:7px 0;
}
.hdr-search input::placeholder{color:var(--text3)}
.hdr-search svg{width:14px;height:14px;color:var(--text3);flex-shrink:0}

/* Theme toggle */
.theme-toggle{
  width:38px;height:38px;border-radius:9px;
  background:var(--bg2);border:1px solid var(--border);
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;transition:all 0.2s;font-size:16px;
}
.theme-toggle:hover{background:var(--bg3);border-color:var(--border2)}

/* User chip */
.user-chip{
  display:flex;align-items:center;gap:8px;
  padding:5px 12px 5px 6px;
  background:var(--bg2);border:1px solid var(--border);
  border-radius:30px;cursor:pointer;
  transition:all 0.2s;
}
.user-chip:hover{border-color:var(--border2);background:var(--bg3)}
.user-avatar{
  width:28px;height:28px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-size:11px;font-weight:800;flex-shrink:0;
}
.ua-s{background:linear-gradient(135deg,#10B981,#059669);color:#fff}
.ua-i{background:linear-gradient(135deg,#F59E0B,#D97706);color:#fff}
.ua-a{background:linear-gradient(135deg,#F43F5E,#be123c);color:#fff}
.uc-name{font-size:13px;font-weight:700;line-height:1.2}
.uc-role{font-size:11px;color:var(--text3)}
.role-dot{width:7px;height:7px;border-radius:50%;flex-shrink:0}
.dot-student{background:var(--green);box-shadow:0 0 5px var(--green)}
.dot-instructor{background:var(--amber);box-shadow:0 0 5px var(--amber)}
.dot-admin{background:var(--rose);box-shadow:0 0 5px var(--rose)}
.signin-btn{
  padding:8px 18px;border-radius:8px;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  border:none;color:#fff;font-weight:700;font-size:13.5px;
  cursor:pointer;transition:all 0.2s;
  box-shadow:0 2px 8px rgba(0,102,255,0.3);
}
.signin-btn:hover{transform:translateY(-1px);box-shadow:0 4px 16px rgba(0,102,255,0.4)}

/* ════ VIEWS ════ */
.view{display:none!important}
.view.active{display:block!important}
#courseView.active{display:flex!important}

/* ════════════════════════════════════════════════
   HOME
════════════════════════════════════════════════ */
#homeView{padding-top:var(--hdr-h)}
.hero{
  min-height:calc(100vh - var(--hdr-h));
  display:flex;align-items:center;
  padding:60px 80px;position:relative;overflow:hidden;
}
[data-theme="light"] .hero{
  background:linear-gradient(160deg,#EEF4FF 0%,#F8FAFF 50%,#F0F7FF 100%);
}
[data-theme="dark"] .hero{background:transparent}
.hero-decor{
  position:absolute;inset:0;z-index:0;pointer-events:none;
}
[data-theme="light"] .hero-decor{
  background:
    radial-gradient(ellipse 50% 60% at 70% 40%,rgba(0,102,255,0.07) 0%,transparent 70%),
    radial-gradient(ellipse 40% 40% at 20% 90%,rgba(0,102,255,0.05) 0%,transparent 60%);
}
[data-theme="dark"] .hero-decor{
  background:
    radial-gradient(ellipse 60% 50% at 70% 50%,rgba(0,102,255,0.14) 0%,transparent 70%),
    radial-gradient(ellipse 40% 40% at 20% 80%,rgba(0,102,255,0.07) 0%,transparent 60%);
}
.hero-grid{
  position:absolute;inset:0;
  background-image:linear-gradient(var(--border) 1px,transparent 1px),linear-gradient(90deg,var(--border) 1px,transparent 1px);
  background-size:56px 56px;
}
.hero-content{position:relative;z-index:1;max-width:700px}
.hero-badge{
  display:inline-flex;align-items:center;gap:8px;
  padding:5px 14px;border-radius:20px;
  border:1px solid rgba(0,102,255,0.25);
  background:rgba(0,102,255,0.07);
  font-size:12px;font-weight:700;color:var(--accent);
  margin-bottom:28px;font-family:'JetBrains Mono',monospace;
}
.hero-badge::before{content:'';width:7px;height:7px;border-radius:50%;background:var(--accent);animation:blink 2s infinite}
@keyframes blink{0%,100%{opacity:1}50%{opacity:0.3}}
.hero h1{
  font-family:'Syne',sans-serif;
  font-size:clamp(40px,5vw,66px);
  font-weight:800;line-height:1.05;
  letter-spacing:-0.03em;margin-bottom:20px;
}
.hero h1 em{
  font-style:normal;
  background:linear-gradient(135deg,var(--accent) 0%,#5B9BFF 60%,var(--violet) 100%);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
}
.hero p{font-size:17px;color:var(--text2);max-width:540px;line-height:1.65;margin-bottom:36px}
.hero-actions{display:flex;gap:12px;flex-wrap:wrap;margin-bottom:50px}
.btn-primary{
  padding:13px 28px;border-radius:10px;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  border:none;color:#fff;font-weight:700;font-size:15px;
  cursor:pointer;transition:all 0.25s;
  box-shadow:0 4px 16px rgba(0,102,255,0.35);
  display:flex;align-items:center;gap:8px;
}
.btn-primary:hover{transform:translateY(-2px);box-shadow:0 8px 28px rgba(0,102,255,0.45)}
.btn-outline{
  padding:13px 28px;border-radius:10px;
  background:transparent;
  border:1.5px solid var(--border2);
  color:var(--text);font-weight:600;font-size:15px;
  cursor:pointer;transition:all 0.25s;
}
.btn-outline:hover{background:var(--bg3);border-color:var(--accent);color:var(--accent)}

/* Provider logos */
.hero-providers{
  border-top:1px solid var(--border);
  padding-top:28px;
}
.hp-label{font-size:12px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:0.1em;margin-bottom:14px}
.provider-logo-row{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
.prov-logo-pill{
  display:flex;align-items:center;gap:8px;
  padding:8px 16px;border-radius:10px;
  border:1.5px solid var(--border);
  background:var(--bg1);
  font-size:13px;font-weight:700;
  transition:all 0.2s;cursor:default;
  box-shadow:var(--shadow);
}
[data-theme="light"] .prov-logo-pill{background:#fff}
.prov-logo-pill:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg)}
.prov-icon{width:20px;height:20px;border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:800;flex-shrink:0}

/* Stats */
.stats-strip{
  display:grid;grid-template-columns:repeat(4,1fr);
  border-top:1px solid var(--border);
}
.stat-cell{
  padding:30px;border-right:1px solid var(--border);
  text-align:center;background:var(--bg1);
}
.stat-cell:last-child{border-right:none}
.stat-num{
  font-family:'Syne',sans-serif;
  font-size:38px;font-weight:800;
  color:var(--accent);
}
.stat-label{font-size:13px;color:var(--text3);margin-top:3px;font-weight:600}

/* ════════════════════════════════════════════════
   CATALOG
════════════════════════════════════════════════ */
#catalogView{padding-top:var(--hdr-h);min-height:100vh}
.cat-hdr{
  padding:36px 52px 24px;
  border-bottom:1px solid var(--border);
  background:var(--bg1);
}
.cat-hdr h1{font-family:'Syne',sans-serif;font-size:26px;font-weight:800;letter-spacing:-0.02em;margin-bottom:4px}
.cat-hdr p{color:var(--text2);font-size:14px}
.provider-tabs{
  display:flex;gap:6px;flex-wrap:wrap;
  padding:14px 52px;border-bottom:1px solid var(--border);
  position:sticky;top:var(--hdr-h);
  background:rgba(var(--bg0-rgb,240,244,250),0.95);
  backdrop-filter:blur(12px);z-index:50;
  background:var(--bg0);
}
.ptab{
  display:flex;align-items:center;gap:7px;
  padding:7px 15px;border-radius:8px;
  border:1.5px solid var(--border);
  background:var(--bg1);cursor:pointer;
  font-size:13px;font-weight:700;color:var(--text2);
  transition:all 0.2s;
}
.ptab:hover{border-color:var(--border2);color:var(--text);box-shadow:var(--shadow)}
.ptab.active{color:#fff!important;border-color:transparent!important}
.ptab-dot{width:8px;height:8px;border-radius:50%}
.ptab.all.active{background:var(--accent)}
.ptab.aws.active{background:var(--aws)}
.ptab.gcp.active{background:var(--gcp)}
.ptab.azure.active{background:var(--azure)}
.ptab.m365.active{background:var(--m365)}
.ptab.comptia.active{background:var(--comptia)}
.ptab.other.active{background:var(--violet)}
.level-row{
  padding:10px 52px;border-bottom:1px solid var(--border);
  display:flex;gap:8px;align-items:center;
  background:var(--bg2);
}
.lr-lbl{font-size:11px;font-weight:800;color:var(--text3);text-transform:uppercase;letter-spacing:0.1em;margin-right:4px}
.lvl-btn{
  padding:4px 13px;border-radius:20px;font-size:12px;font-weight:700;
  border:1.5px solid var(--border);background:transparent;
  color:var(--text2);cursor:pointer;font-family:inherit;transition:all 0.15s;
}
.lvl-btn:hover{border-color:var(--border2);color:var(--text)}
.lvl-btn.active{color:#fff;border-color:transparent}
.lvl-btn.all.active{background:var(--accent)}
.lvl-btn.Fundamentals.active{background:var(--fund)}
.lvl-btn.Associate.active{background:var(--assoc)}
.lvl-btn.Professional.active{background:var(--pro)}
.lvl-btn.Expert.active{background:var(--expert)}
.lvl-btn.Specialty.active{background:var(--spec)}
.courses-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(320px,1fr));
  gap:18px;padding:28px 52px 80px;
}

/* Course card */
.course-card{
  background:var(--bg1);border:1.5px solid var(--border);
  border-radius:var(--r-lg);overflow:hidden;cursor:pointer;
  transition:all 0.25s;position:relative;
  box-shadow:var(--shadow);
}
.course-card:hover{
  transform:translateY(-3px);
  border-color:var(--border2);
  box-shadow:var(--card-hover-shadow);
}
.cc-accent-bar{height:4px;width:100%}
.cc-top{padding:20px 20px 14px}
.cc-prov-row{display:flex;align-items:center;gap:10px;margin-bottom:14px}
.prov-badge{
  display:flex;align-items:center;gap:6px;
  font-family:'JetBrains Mono',monospace;
  font-size:11.5px;font-weight:600;
  padding:4px 10px;border-radius:6px;
  border:1.5px solid currentColor;
}
.lv-badge{
  font-size:10.5px;font-weight:800;padding:3px 9px;
  border-radius:5px;text-transform:uppercase;letter-spacing:0.06em;margin-left:auto;
}
.lv-Fundamentals{background:rgba(59,130,246,0.12);color:var(--fund)}
.lv-Associate{background:rgba(16,185,129,0.12);color:var(--assoc)}
.lv-Professional{background:rgba(139,92,246,0.12);color:var(--pro)}
.lv-Expert{background:rgba(244,63,94,0.12);color:var(--expert)}
.lv-Specialty{background:rgba(245,158,11,0.12);color:var(--spec)}
.course-card h3{font-family:'Syne',sans-serif;font-size:16px;font-weight:700;margin-bottom:6px;line-height:1.3}
.course-card p{font-size:13px;color:var(--text2);line-height:1.6}
.cc-meta{
  padding:12px 20px;border-top:1px solid var(--border);
  display:flex;align-items:center;gap:14px;
}
.cm{display:flex;align-items:center;gap:5px;font-size:12px;color:var(--text3);font-weight:600}
.cm svg{width:12px;height:12px}
.cc-prog-wrap{margin-left:auto;display:flex;flex-direction:column;align-items:flex-end;gap:3px}
.cc-prog-bar{width:70px;height:5px;background:var(--bg4);border-radius:3px;overflow:hidden}
.cc-prog-fill{height:100%;border-radius:3px;transition:width 0.6s}
.cc-prog-pct{font-size:11px;font-weight:800;font-family:'JetBrains Mono',monospace}
.cc-footer{
  padding:12px 20px;background:var(--bg2);
  border-top:1px solid var(--border);
  display:flex;align-items:center;justify-content:space-between;
}
.open-btn{
  display:flex;align-items:center;gap:6px;
  color:var(--accent);font-weight:700;font-size:13.5px;
  background:none;border:none;cursor:pointer;font-family:inherit;
  transition:gap 0.2s;
}
.open-btn:hover{gap:10px}
.open-btn svg{width:14px;height:14px}
.cert-id{font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--text3)}

/* ════════════════════════════════════════════════
   COURSE VIEW — FULL WIDTH CONTENT
════════════════════════════════════════════════ */
#courseView{padding-top:var(--hdr-h)}

/* Sidebar */
.c-sidebar{
  width:var(--sidebar-w);flex-shrink:0;
  background:var(--bg1);border-right:1.5px solid var(--border);
  position:fixed;top:var(--hdr-h);left:0;bottom:0;
  overflow-y:auto;z-index:100;
  display:flex;flex-direction:column;
}
.csb-hdr{
  padding:18px 16px;border-bottom:1px solid var(--border);
  position:sticky;top:0;background:var(--bg1);z-index:5;
}
.csb-back{
  display:flex;align-items:center;gap:6px;
  color:var(--text3);font-size:12px;font-weight:700;
  cursor:pointer;margin-bottom:12px;transition:color 0.15s;
}
.csb-back:hover{color:var(--accent)}
.csb-back svg{width:13px;height:13px}
.csb-id{
  font-family:'JetBrains Mono',monospace;font-size:11.5px;font-weight:600;
  padding:3px 9px;border-radius:5px;display:inline-block;margin-bottom:8px;
  border:1.5px solid currentColor;
}
.csb-title{font-size:13.5px;font-weight:700;line-height:1.35}
.csb-prog-wrap{display:flex;align-items:center;gap:8px;margin-top:10px}
.csb-prog-wrap .prog-bar{flex:1;height:5px;background:var(--bg4);border-radius:3px;overflow:hidden}
.csb-pct{font-size:11.5px;font-weight:800;font-family:'JetBrains Mono',monospace;color:var(--accent)}

/* Module tree */
.module-list{padding:8px 0 40px;flex:1}
.mod-item{border-bottom:1px solid var(--border)}
.mod-hdr{
  display:flex;align-items:center;gap:8px;
  padding:10px 14px;cursor:pointer;user-select:none;
  transition:background 0.15s;
}
.mod-hdr:hover{background:var(--bg2)}
.mod-hdr.exp{background:var(--bg2)}
.mod-num{
  width:22px;height:22px;border-radius:5px;
  font-size:10px;font-weight:800;
  display:flex;align-items:center;justify-content:center;
  color:#fff;flex-shrink:0;font-family:'JetBrains Mono',monospace;
}
.mod-title{font-size:12.5px;font-weight:700;flex:1;color:var(--text2);line-height:1.3}
.mod-hdr.exp .mod-title{color:var(--text)}
.mod-chev{width:14px;height:14px;color:var(--text3);transition:transform 0.25s;flex-shrink:0}
.mod-hdr.exp .mod-chev{transform:rotate(90deg)}
.mod-cnt{font-size:10px;font-weight:700;color:var(--text3);background:var(--bg3);padding:2px 6px;border-radius:7px;flex-shrink:0}
.mod-subitems{display:none}
.mod-subitems.open{display:block}
.sub-item{
  display:flex;align-items:center;gap:7px;
  padding:8px 14px 8px 40px;
  cursor:pointer;border-left:2px solid transparent;
  transition:all 0.15s;font-size:12.5px;color:var(--text3);
}
.sub-item:hover{background:rgba(0,102,255,0.04);color:var(--text2)}
.sub-item.active{background:rgba(0,102,255,0.07);color:var(--accent);border-left-color:var(--accent);font-weight:700}
.si-check{
  width:16px;height:16px;border-radius:50%;
  border:2px solid var(--border2);flex-shrink:0;
  display:flex;align-items:center;justify-content:center;
  transition:all 0.2s;
}
.si-check.done{background:var(--green);border-color:var(--green)}
.si-check.done::after{content:'✓';font-size:9px;color:#fff;font-weight:800}
.si-type{
  font-size:9px;font-weight:800;text-transform:uppercase;letter-spacing:0.07em;
  padding:1px 5px;border-radius:3px;margin-left:auto;flex-shrink:0;
  font-family:'JetBrains Mono',monospace;
}
.si-doc{background:rgba(0,102,255,0.1);color:var(--accent)}
.si-lab{background:rgba(16,185,129,0.1);color:var(--green)}
.si-video{background:rgba(244,63,94,0.1);color:var(--rose)}

/* Main content — full width */
.c-main{
  margin-left:var(--sidebar-w);
  flex:1;min-height:calc(100vh - var(--hdr-h));
  background:var(--bg0);
}
.content-area{
  max-width:880px;margin:0 auto;
  padding:40px 56px 80px;
}

/* Breadcrumb */
.bcrumb{
  display:flex;align-items:center;gap:6px;
  font-size:12px;color:var(--text3);margin-bottom:22px;
  flex-wrap:wrap;
}
.bcrumb a{color:var(--accent);cursor:pointer;font-weight:600}
.bcrumb a:hover{text-decoration:underline}

.page-type-chip{
  display:inline-flex;align-items:center;gap:6px;
  padding:4px 13px;border-radius:20px;font-size:11.5px;font-weight:800;
  text-transform:uppercase;letter-spacing:0.06em;margin-bottom:12px;
}
.ptc-doc{background:rgba(0,102,255,0.1);color:var(--accent);border:1px solid rgba(0,102,255,0.2)}
.ptc-lab{background:rgba(16,185,129,0.1);color:var(--green);border:1px solid rgba(16,185,129,0.2)}
.ptc-video{background:rgba(244,63,94,0.1);color:var(--rose);border:1px solid rgba(244,63,94,0.2)}
.ptc-doc svg,.ptc-lab svg,.ptc-video svg{width:12px;height:12px}

/* Complete checkbox in page header */
.page-hdr-row{
  display:flex;align-items:flex-start;
  justify-content:space-between;gap:16px;
  margin-bottom:24px;
}
.page-title{
  font-family:'Syne',sans-serif;font-size:30px;font-weight:800;
  letter-spacing:-0.02em;line-height:1.2;flex:1;outline:none;
}
.page-title[contenteditable="true"]{border-bottom:2px dashed var(--accent)}
.complete-btn{
  display:flex;align-items:center;gap:8px;
  padding:9px 18px;border-radius:9px;flex-shrink:0;margin-top:6px;
  border:1.5px solid var(--border2);background:var(--bg2);
  cursor:pointer;font-family:inherit;font-size:13px;font-weight:700;
  color:var(--text2);transition:all 0.2s;
}
.complete-btn:hover{border-color:var(--green);color:var(--green);background:rgba(16,185,129,0.06)}
.complete-btn.done{background:rgba(16,185,129,0.1);border-color:var(--green);color:var(--green)}
.complete-btn svg{width:16px;height:16px;transition:all 0.2s}
.complete-btn.done svg circle{fill:var(--green)}
.complete-btn.done svg path{stroke:#fff}
.cbtn-login{display:flex;align-items:center;gap:6px;padding:9px 14px;border-radius:9px;flex-shrink:0;margin-top:6px;background:rgba(0,102,255,0.06);border:1.5px dashed rgba(0,102,255,0.25);color:var(--accent);font-size:12.5px;font-weight:600;cursor:pointer;font-family:inherit;transition:all 0.2s}
.cbtn-login:hover{background:rgba(0,102,255,0.1)}

/* Edit toggle */
.edit-toggle-wrap{
  display:flex;align-items:center;gap:8px;
  padding:7px 12px;border-radius:8px;
  background:var(--bg3);border:1px solid var(--border);
  font-size:12px;font-weight:700;cursor:pointer;
  transition:all 0.2s;color:var(--text3);
}
.edit-toggle-wrap.on{background:rgba(0,102,255,0.08);border-color:var(--accent);color:var(--accent)}

/* Blocks */
.blocks-container{margin-top:4px}
.block{position:relative;margin-bottom:8px;border-radius:7px;transition:outline 0.15s}
body.edit-mode .block:hover{outline:1.5px dashed rgba(0,102,255,0.35)}
body.edit-mode .block:hover .btb-wrap{opacity:1;pointer-events:all}
.btb-wrap{position:absolute;top:-12px;right:0;display:flex;gap:3px;opacity:0;pointer-events:none;transition:opacity 0.15s;z-index:10}
.btb{
  width:22px;height:22px;border-radius:4px;
  border:1px solid var(--border2);background:var(--bg1);
  cursor:pointer;font-size:10px;
  display:flex;align-items:center;justify-content:center;
  color:var(--text3);transition:all 0.15s;
}
.btb.del:hover{background:#FEE2E2;color:var(--rose);border-color:var(--rose)}
.btb.mov:hover{background:rgba(0,102,255,0.08);color:var(--accent);border-color:var(--accent)}

.b-text p{margin-bottom:14px;color:var(--text2);font-size:14.5px;line-height:1.8}
.b-text p[contenteditable]{outline:none;border-bottom:1px dashed var(--accent);background:rgba(0,102,255,0.03);padding:4px;border-radius:4px 4px 0 0}
h2.b-h{font-family:'Syne',sans-serif;font-size:21px;font-weight:800;color:var(--text);margin:8px 0 14px;padding-bottom:8px;border-bottom:2px solid var(--border)}
h2.b-h[contenteditable]{outline:none;border-bottom:2px dashed var(--accent)}
.callout{padding:14px 18px;border-radius:9px;display:flex;gap:12px;font-size:13.5px;margin:4px 0}
.callout.note{background:rgba(0,102,255,0.06);border-left:3px solid var(--accent)}
.callout.tip{background:rgba(16,185,129,0.06);border-left:3px solid var(--green)}
.callout.warning{background:rgba(245,158,11,0.06);border-left:3px solid var(--amber)}
.callout.danger{background:rgba(244,63,94,0.06);border-left:3px solid var(--rose)}
.c-ico{font-size:17px;flex-shrink:0;margin-top:1px}
.c-body{flex:1;color:var(--text2)}
.c-body[contenteditable]{outline:none}
pre.b-code{
  background:var(--bg2);border:1.5px solid var(--border);border-radius:9px;
  padding:18px 20px;overflow-x:auto;margin:4px 0;
  border-left:3px solid var(--accent);
  font-family:'JetBrains Mono',monospace;font-size:13px;line-height:1.6;
}
[data-theme="dark"] pre.b-code{color:#7DD3FC}
[data-theme="light"] pre.b-code{color:#1E40AF}
pre.b-code[contenteditable]{outline:1px dashed var(--accent)}
.b-video{margin:4px 0;border-radius:10px;overflow:hidden;border:1.5px solid var(--border)}
.video-wrapper{position:relative;width:100%;padding-bottom:56.25%;background:var(--bg3)}
.video-wrapper iframe{position:absolute;inset:0;width:100%;height:100%;border:none}
.video-ph{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;color:var(--text3)}
.v-cap{padding:10px 16px;font-size:13px;color:var(--text3);background:var(--bg2);border-top:1px solid var(--border)}
.b-image{margin:4px 0;border-radius:10px;overflow:hidden;border:1.5px solid var(--border)}
.img-ph{background:var(--bg3);height:180px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:10px;color:var(--text3);cursor:pointer;transition:background 0.15s}
.img-ph:hover{background:var(--bg4)}
.img-ph svg{width:32px;height:32px}
.img-actual{width:100%;display:block}
.i-cap{padding:10px 16px;font-size:13px;color:var(--text3);background:var(--bg2);border-top:1px solid var(--border)}
.b-link-card{
  display:flex;align-items:center;gap:14px;
  padding:14px 18px;border:1.5px solid var(--border);border-radius:9px;
  background:var(--bg1);margin:4px 0;transition:all 0.2s;cursor:pointer;
}
.b-link-card:hover{border-color:var(--accent);background:rgba(0,102,255,0.04)}
.b-link-icon{width:36px;height:36px;border-radius:8px;background:rgba(0,102,255,0.1);display:flex;align-items:center;justify-content:center;flex-shrink:0}
.b-link-icon svg{width:18px;height:18px;color:var(--accent)}
.blk-lt{font-size:14px;font-weight:700;color:var(--text)}
.blk-ld{font-size:12.5px;color:var(--text3);margin-top:2px}
.blk-arr{margin-left:auto;color:var(--text3)}
.blk-arr svg{width:16px;height:16px}
.b-card{border:1.5px solid var(--border);border-radius:10px;padding:18px 20px;background:var(--bg2);margin:4px 0}
.b-card h4{font-size:14.5px;font-weight:700;margin-bottom:6px;color:var(--text)}
.b-card h4[contenteditable]{outline:none;border-bottom:1px dashed var(--accent)}
.b-card p{font-size:13.5px;color:var(--text2)}
.b-card p[contenteditable]{outline:none}
/* Lab */
.lab-header-bar{
  background:linear-gradient(135deg,rgba(16,185,129,0.1),rgba(16,185,129,0.04));
  border:1.5px solid rgba(16,185,129,0.2);border-radius:12px;
  padding:20px 24px;margin-bottom:20px;
  display:flex;align-items:center;gap:16px;
}
.lab-ico{width:48px;height:48px;border-radius:12px;background:rgba(16,185,129,0.15);display:flex;align-items:center;justify-content:center;flex-shrink:0}
.lab-ico svg{width:26px;height:26px;color:var(--green)}
.lab-hdr-text h3{font-family:'Syne',sans-serif;font-size:17px;font-weight:800;color:var(--green)}
.lab-hdr-text p{font-size:13px;color:var(--text3)}
.lab-meta-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:20px}
.lab-mc{background:var(--bg2);border:1.5px solid var(--border);border-radius:9px;padding:14px;text-align:center}
.lab-mc .lmv{font-family:'JetBrains Mono',monospace;font-size:20px;font-weight:700;color:var(--green)}
.lab-mc .lmk{font-size:11px;color:var(--text3);margin-top:2px;font-weight:700}
.step-block{border:1.5px solid var(--border);border-radius:10px;margin:8px 0;overflow:hidden;background:var(--bg1)}
.step-hdr{display:flex;align-items:center;gap:10px;padding:12px 18px;background:var(--bg2);border-bottom:1px solid var(--border)}
.step-num-b{width:26px;height:26px;border-radius:50%;background:var(--green);color:#fff;font-size:12px;font-weight:800;display:flex;align-items:center;justify-content:center;flex-shrink:0;font-family:'JetBrains Mono',monospace}
.step-hdr h4{font-size:14px;font-weight:700;flex:1}
.step-done-btn{padding:4px 12px;border-radius:20px;font-size:11.5px;font-weight:700;border:none;cursor:pointer;font-family:inherit;transition:all 0.2s}
.s-done{background:rgba(16,185,129,0.12);color:var(--green);border:1px solid rgba(16,185,129,0.3)}
.s-undone{background:var(--bg3);color:var(--text3);border:1px solid var(--border)}
.step-body{padding:16px 20px;font-size:13.5px;color:var(--text2);line-height:1.75}
/* Add blocks */
.add-block-bar{display:none;flex-wrap:wrap;gap:6px;margin:20px 0;align-items:center;padding:14px;background:var(--bg2);border:1px dashed var(--border2);border-radius:9px}
body.edit-mode .add-block-bar{display:flex}
.abl{font-size:11px;font-weight:800;color:var(--text3);text-transform:uppercase;letter-spacing:0.08em;width:100%;margin-bottom:2px}
.abb{display:flex;align-items:center;gap:5px;padding:5px 10px;border-radius:6px;border:1px solid var(--border);background:var(--bg1);font-family:inherit;font-size:12px;color:var(--text3);cursor:pointer;transition:all 0.15s}
.abb:hover{border-color:var(--accent);color:var(--accent);background:rgba(0,102,255,0.05)}
/* Page nav */
.page-nav{display:flex;justify-content:space-between;margin-top:48px;padding-top:24px;border-top:1px solid var(--border);gap:14px}
.pn-btn{display:flex;flex-direction:column;color:var(--text);padding:14px 18px;border:1.5px solid var(--border);border-radius:9px;flex:1;max-width:46%;transition:all 0.2s;background:var(--bg1);cursor:pointer;font-family:inherit;text-align:left;box-shadow:var(--shadow)}
.pn-btn:hover{border-color:var(--accent);background:rgba(0,102,255,0.04)}
.pn-dir{font-size:11px;font-weight:800;text-transform:uppercase;letter-spacing:0.1em;color:var(--text3);margin-bottom:3px}
.pn-title{font-size:14px;font-weight:700;color:var(--accent)}
.pn-btn.right{text-align:right;margin-left:auto}
/* Edit FAB */
.edit-fab{position:fixed;bottom:22px;left:calc(var(--sidebar-w) + 22px);display:none;align-items:center;gap:10px;background:var(--accent);color:#fff;padding:9px 18px;border-radius:30px;box-shadow:0 4px 16px rgba(0,102,255,0.4);z-index:200;font-size:12.5px;font-weight:700;font-family:'JetBrains Mono',monospace}
body.edit-mode .edit-fab{display:flex}
.edit-fab button{background:rgba(255,255,255,0.2);border:1px solid rgba(255,255,255,0.3);color:#fff;padding:3px 10px;border-radius:20px;cursor:pointer;font-family:inherit;font-size:12px;font-weight:600}

/* ════════════════════════════════════════════════
   MANAGER
════════════════════════════════════════════════ */
#managerView{padding-top:var(--hdr-h);min-height:100vh}
.mgr-hdr{background:var(--bg1);padding:32px 52px;border-bottom:1px solid var(--border)}
.mgr-hdr h1{font-family:'Syne',sans-serif;font-size:24px;font-weight:800}
.mgr-hdr p{color:var(--text2);font-size:13.5px;margin-top:4px}
.mgr-tabs{display:flex;gap:0;margin-top:20px;border-bottom:1px solid var(--border)}
.m-tab{padding:8px 20px;font-size:13px;font-weight:700;cursor:pointer;border:none;background:transparent;font-family:inherit;transition:all 0.15s;color:var(--text3);border-bottom:2px solid transparent;margin-bottom:-1px}
.m-tab:hover{color:var(--text2)}
.m-tab.active{color:var(--accent);border-bottom-color:var(--accent)}
.mgr-body{padding:32px 52px}
.perm-table{width:100%;border-collapse:collapse}
.perm-table th{background:var(--bg2);color:var(--text3);padding:10px 16px;font-size:11px;font-weight:800;text-align:left;text-transform:uppercase;letter-spacing:0.08em;border-bottom:1.5px solid var(--border)}
.perm-table td{padding:12px 16px;border-bottom:1px solid var(--border);font-size:13.5px;vertical-align:middle}
.perm-table tr:hover td{background:var(--bg2)}
.u-av{width:32px;height:32px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;font-size:11px;font-weight:800;color:#fff;flex-shrink:0}
.av-a{background:linear-gradient(135deg,var(--rose),#be123c)}
.av-i{background:linear-gradient(135deg,var(--amber),#d97706)}
.av-s{background:linear-gradient(135deg,var(--green),#059669)}
.perm-sel{padding:5px 10px;border:1.5px solid var(--border);border-radius:6px;font-family:inherit;font-size:13px;background:var(--bg2);cursor:pointer;outline:none;color:var(--text)}
.mgr-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:14px}
.mgr-card{background:var(--bg1);border:1.5px solid var(--border);border-radius:var(--r-lg);padding:18px;box-shadow:var(--shadow);transition:all 0.2s}
.mgr-card:hover{border-color:var(--border2)}
.mgr-card h4{font-size:14.5px;font-weight:700;margin-bottom:3px}
.mgr-card p{font-size:12.5px;color:var(--text3)}
.mgr-actions{display:flex;gap:8px;margin-top:14px}
.mc-btn{flex:1;padding:7px;border-radius:6px;font-size:12.5px;font-weight:700;font-family:inherit;cursor:pointer;transition:all 0.15s;border:1.5px solid var(--border);background:var(--bg2);color:var(--text2)}
.mc-btn:hover{border-color:var(--border2);color:var(--text)}
.mc-btn.primary{background:var(--accent);color:#fff;border-color:var(--accent)}
.mc-btn.primary:hover{background:var(--accent2)}
.mc-btn.danger{background:rgba(244,63,94,0.08);color:var(--rose);border-color:rgba(244,63,94,0.25)}
.req-badge{display:inline-flex;align-items:center;gap:5px;font-size:11px;font-weight:800;padding:3px 9px;border-radius:20px}
.req-pending{background:rgba(245,158,11,0.12);color:var(--amber)}
.req-approved{background:rgba(16,185,129,0.12);color:var(--green)}
.req-rejected{background:rgba(244,63,94,0.12);color:var(--rose)}

/* ════════════════════════════════════════════════
   MODALS
════════════════════════════════════════════════ */
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.55);backdrop-filter:blur(8px);z-index:800;align-items:center;justify-content:center}
.modal-overlay.open{display:flex}
.modal{background:var(--bg1);border:1.5px solid var(--border2);border-radius:var(--r-lg);padding:28px 32px;min-width:380px;max-width:520px;width:90%;box-shadow:var(--shadow-lg);animation:mIn 0.2s cubic-bezier(.34,1.2,.64,1)}
@keyframes mIn{from{opacity:0;transform:scale(0.93) translateY(-12px)}to{opacity:1;transform:none}}
.modal h3{font-family:'Syne',sans-serif;font-size:20px;font-weight:800;margin-bottom:20px}
.modal label{font-size:11px;font-weight:800;color:var(--text3);display:block;margin-bottom:5px;margin-top:14px;text-transform:uppercase;letter-spacing:0.08em}
.modal input,.modal select,.modal textarea{width:100%;padding:9px 12px;border:1.5px solid var(--border2);border-radius:7px;font-family:inherit;font-size:13.5px;color:var(--text);background:var(--bg2);outline:none;transition:border-color 0.15s}
.modal input:focus,.modal select:focus,.modal textarea:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(0,102,255,0.1)}
.modal textarea{resize:vertical;min-height:80px}
.modal input[type="password"]{font-family:'JetBrains Mono',monospace;letter-spacing:0.1em}
.modal-actions{display:flex;gap:10px;margin-top:24px;justify-content:flex-end}
.mbtn-p{background:var(--accent);color:#fff;border:none;padding:10px 22px;border-radius:8px;font-family:inherit;font-size:13.5px;font-weight:700;cursor:pointer;transition:all 0.2s}
.mbtn-p:hover{background:var(--accent2);transform:translateY(-1px)}
.mbtn-s{background:transparent;color:var(--text2);border:1.5px solid var(--border2);padding:10px 22px;border-radius:8px;font-family:inherit;font-size:13.5px;cursor:pointer;transition:all 0.15s}
.mbtn-s:hover{border-color:var(--border2);color:var(--text)}
.err-msg{background:rgba(244,63,94,0.08);border:1px solid rgba(244,63,94,0.25);color:var(--rose);font-size:13px;padding:9px 12px;border-radius:7px;margin-top:10px;display:none}
.err-msg.show{display:block}
.success-screen{text-align:center;padding:8px 0}
.succ-ico{font-size:52px;margin-bottom:16px}
.success-screen h3{font-family:'Syne',sans-serif;font-size:20px;font-weight:800;margin-bottom:8px}
.success-screen p{font-size:13.5px;color:var(--text2);max-width:360px;margin:0 auto}
/* Login modal */
.login-logo{text-align:center;margin-bottom:20px}
.ll-inner{display:inline-flex;align-items:center;gap:10px}
.ll-mark{width:44px;height:44px;background:linear-gradient(135deg,var(--accent),var(--accent2));border-radius:12px;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 14px rgba(0,102,255,0.35)}
.ll-mark svg{width:24px;height:24px}
.ll-name{font-family:'JetBrains Mono',monospace;font-size:16px;font-weight:600}
.ll-name span{color:var(--accent)}
.login-sub{font-size:13px;color:var(--text3);text-align:center;margin-bottom:4px}
/* Become instructor banner */
.become-banner{
  background:linear-gradient(135deg,rgba(245,158,11,0.07),rgba(245,158,11,0.02));
  border:1.5px solid rgba(245,158,11,0.18);border-radius:10px;
  padding:16px 20px;margin-bottom:20px;
  display:flex;align-items:center;gap:14px;
}
.bb-ico{font-size:30px;flex-shrink:0}
.bb-text h4{font-size:14.5px;font-weight:700;color:var(--amber)}
.bb-text p{font-size:12.5px;color:var(--text3)}
.bb-btn{margin-left:auto;flex-shrink:0;padding:8px 16px;border-radius:7px;background:linear-gradient(135deg,var(--amber),#d97706);border:none;color:#000;font-weight:700;font-size:13px;font-family:inherit;cursor:pointer;transition:all 0.2s;white-space:nowrap}
.bb-btn:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(245,158,11,0.3)}
/* User menu */
.user-menu{position:fixed;z-index:600;background:var(--bg1);border:1.5px solid var(--border2);border-radius:11px;min-width:220px;box-shadow:var(--shadow-lg);display:none}
.user-menu.open{display:block;animation:mIn 0.16s ease}
.um-hdr{padding:14px 16px;border-bottom:1px solid var(--border)}
.um-name{font-size:14px;font-weight:700}
.um-email{font-size:12px;color:var(--text3);margin-top:1px}
.um-item{display:flex;align-items:center;gap:10px;padding:10px 16px;cursor:pointer;font-size:13.5px;color:var(--text2);transition:all 0.15s}
.um-item:hover{background:var(--bg2);color:var(--text)}
.um-item svg{width:14px;height:14px;flex-shrink:0}
.um-item.danger{color:var(--rose)}
.um-item.danger:hover{background:rgba(244,63,94,0.06)}
.um-sep{height:1px;background:var(--border)}
/* Toast */
.toast{position:fixed;bottom:22px;right:22px;background:var(--bg1);border:1.5px solid var(--border2);color:var(--text);font-size:13px;font-weight:600;padding:11px 18px;border-radius:9px;box-shadow:var(--shadow-lg);display:flex;align-items:center;gap:8px;opacity:0;transform:translateY(10px);transition:all 0.3s;z-index:900;pointer-events:none}
.toast.show{opacity:1;transform:translateY(0)}
.toast.green{border-left:3px solid var(--green)}
.toast.cyan{border-left:3px solid var(--accent)}
.toast.amber{border-left:3px solid var(--amber)}
.toast.red{border-left:3px solid var(--rose)}
/* Sec label */
.sec-lbl{font-size:11px;font-weight:800;text-transform:uppercase;letter-spacing:0.12em;color:var(--text3);margin-bottom:14px;padding-bottom:8px;border-bottom:1.5px solid var(--border)}
</style>
</head>
<body>

<!-- HEADER -->
<header>
  <div class="logo-wrap" onclick="showView('home')">
    <div class="logo-mark">
      <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
    </div>
    <span class="logo-text">codethebox<span class="logo-tld">.dev</span></span>
  </div>
  <div class="hdr-div"></div>
  <nav class="hdr-nav">
    <button class="hdr-btn" id="navHome" onclick="showView('home')">Home</button>
    <button class="hdr-btn" id="navCatalog" onclick="showView('catalog')">Course Catalog</button>
    <button class="hdr-btn" id="navCourse" style="display:none" onclick="showView('course')">Course</button>
  </nav>
  <div class="hdr-right">
    <div class="hdr-search">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
      <input type="text" placeholder="Search courses...">
    </div>
    <button class="theme-toggle" id="themeBtn" onclick="toggleTheme()" title="Toggle theme">☀️</button>
    <div id="userArea"></div>
  </div>
</header>

<!-- User Menu -->
<div class="user-menu" id="userMenu">
  <div class="um-hdr">
    <div class="um-name" id="umName">Guest</div>
    <div class="um-email" id="umEmail">Not signed in</div>
  </div>
  <div class="um-item" id="umSignIn" onclick="openModal('loginModal')">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 3h4a2 2 0 012 2v14a2 2 0 01-2 2h-4"/><polyline points="10 17 15 12 10 7"/><line x1="15" y1="12" x2="3" y2="12"/></svg>
    Sign In
  </div>
  <div class="um-item" id="umInstructor" onclick="openModal('instructorApplyModal')">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 013 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
    Become an Instructor
  </div>
  <div class="um-sep"></div>
  <div class="um-item" id="umManage" style="display:none" onclick="showView('manager')">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.07 4.93a10 10 0 010 14.14"/><path d="M4.93 4.93a10 10 0 000 14.14"/></svg>
    Manage Portal
  </div>
  <div class="um-item danger" id="umLogout" style="display:none" onclick="logout()">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
    Sign Out
  </div>
</div>

<!-- ════════════════════ VIEWS ════════════════════ -->

<!-- HOME -->
<div id="homeView" class="view">
  <div class="hero">
    <div class="hero-decor"></div>
    <div class="hero-grid"></div>
    <div class="hero-content">
      <div class="hero-badge">✦ Multi-Cloud Certification Platform</div>
      <h1>Code your path to<br><em>cloud mastery</em></h1>
      <p>Structured learning paths, hands-on labs, and expert content for AWS, Google Cloud, Azure, Microsoft 365, CompTIA, and more.</p>
      <div class="hero-actions">
        <button class="btn-primary" onclick="showView('catalog')">
          Explore Courses
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
        </button>
        <button class="btn-outline" id="heroSignInBtn" onclick="openModal('loginModal')">Sign In</button>
      </div>
      <div class="hero-providers">
        <div class="hp-label">Technology Paths</div>
        <div class="provider-logo-row" id="providerLogoRow"></div>
      </div>
    </div>
  </div>
  <div class="stats-strip">
    <div class="stat-cell"><div class="stat-num" id="statCourses">12</div><div class="stat-label">Courses</div></div>
    <div class="stat-cell"><div class="stat-num">60+</div><div class="stat-label">Modules</div></div>
    <div class="stat-cell"><div class="stat-num">50+</div><div class="stat-label">Hands-on Labs</div></div>
    <div class="stat-cell"><div class="stat-num">5+</div><div class="stat-label">Cloud Platforms</div></div>
  </div>
</div>

<!-- CATALOG -->
<div id="catalogView" class="view">
  <div class="cat-hdr">
    <h1>Course Catalog</h1>
    <p>Browse certifications across cloud providers and technology platforms</p>
  </div>
  <div class="provider-tabs" id="providerTabs">
    <button class="ptab all active" onclick="filterProvider('all',this)"><span class="ptab-dot" style="background:var(--accent)"></span>All</button>
    <button class="ptab aws" onclick="filterProvider('AWS',this)"><span class="ptab-dot" style="background:var(--aws)"></span>Amazon AWS</button>
    <button class="ptab gcp" onclick="filterProvider('GCP',this)"><span class="ptab-dot" style="background:var(--gcp)"></span>Google Cloud</button>
    <button class="ptab azure" onclick="filterProvider('Azure',this)"><span class="ptab-dot" style="background:var(--azure)"></span>Microsoft Azure</button>
    <button class="ptab m365" onclick="filterProvider('M365',this)"><span class="ptab-dot" style="background:var(--m365)"></span>Microsoft 365</button>
    <button class="ptab comptia" onclick="filterProvider('CompTIA',this)"><span class="ptab-dot" style="background:var(--comptia)"></span>CompTIA</button>
    <button class="ptab other" onclick="filterProvider('Other',this)"><span class="ptab-dot" style="background:var(--violet)"></span>More</button>
  </div>
  <div class="level-row">
    <span class="lr-lbl">Level:</span>
    <button class="lvl-btn all active" onclick="filterLevel('all',this)">All</button>
    <button class="lvl-btn Fundamentals" onclick="filterLevel('Fundamentals',this)">Fundamentals</button>
    <button class="lvl-btn Associate" onclick="filterLevel('Associate',this)">Associate</button>
    <button class="lvl-btn Professional" onclick="filterLevel('Professional',this)">Professional</button>
    <button class="lvl-btn Expert" onclick="filterLevel('Expert',this)">Expert</button>
    <button class="lvl-btn Specialty" onclick="filterLevel('Specialty',this)">Specialty</button>
  </div>
  <div class="courses-grid" id="coursesGrid"></div>
</div>

<!-- COURSE -->
<div id="courseView" class="view">
  <div class="c-sidebar">
    <div class="csb-hdr">
      <div class="csb-back" onclick="showView('catalog')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M19 12H5M12 5l-7 7 7 7"/></svg>
        Back to Catalog
      </div>
      <span class="csb-id" id="sbId">AZ-900</span>
      <div class="csb-title" id="sbTitle">Course</div>
      <div class="csb-prog-wrap">
        <div class="prog-bar"><div id="sbProg" style="height:100%;border-radius:3px;width:0%;transition:width 0.5s"></div></div>
        <span class="csb-pct" id="sbPct">0%</span>
      </div>
    </div>
    <div class="module-list" id="moduleList"></div>
  </div>
  <div class="c-main">
    <div class="content-area" id="contentArea"></div>
  </div>
</div>

<!-- MANAGER -->
<div id="managerView" class="view">
  <div class="mgr-hdr">
    <h1>⚙ Portal Management</h1>
    <p>Manage courses, users, and instructor requests</p>
    <div class="mgr-tabs">
      <button class="m-tab active" onclick="switchMgrTab('courses',this)">Courses</button>
      <button class="m-tab" onclick="switchMgrTab('users',this)">Users</button>
      <button class="m-tab" onclick="switchMgrTab('requests',this)">Instructor Requests</button>
    </div>
  </div>
  <div class="mgr-body">
    <div id="mgrCourses">
      <div style="display:flex;gap:10px;margin-bottom:18px">
        <button class="mbtn-p" onclick="openModal('addCourseModal')">+ New Course</button>
      </div>
      <div class="mgr-grid" id="mgrCoursesGrid"></div>
    </div>
    <div id="mgrUsers" style="display:none">
      <div style="display:flex;gap:10px;margin-bottom:18px">
        <button class="mbtn-p" onclick="openModal('addUserModal')">+ Add User</button>
      </div>
      <table class="perm-table" id="permTable"></table>
    </div>
    <div id="mgrRequests" style="display:none">
      <div class="sec-lbl">Instructor Applications</div>
      <table class="perm-table" id="requestsTable"></table>
    </div>
  </div>
</div>

<!-- Edit FAB -->
<div class="edit-fab">
  <span>✏ EDIT MODE</span>
  <button onclick="toggleEdit(false)">Exit</button>
</div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<!-- ════════════════════ MODALS ════════════════════ -->

<!-- LOGIN -->
<div class="modal-overlay" id="loginModal">
  <div class="modal" style="max-width:400px">
    <div class="login-logo">
      <div class="ll-inner">
        <div class="ll-mark"><svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg></div>
        <span class="ll-name">codethebox<span>.dev</span></span>
      </div>
    </div>
    <div class="login-sub">Sign in to track your progress and access courses</div>
    <label>Email</label>
    <input type="email" id="loginEmail" placeholder="your@email.com" onkeydown="if(event.key==='Enter')doLogin()">
    <label>Password</label>
    <input type="password" id="loginPass" placeholder="••••••••" onkeydown="if(event.key==='Enter')doLogin()">
    <div class="err-msg" id="loginError">Invalid credentials. Try again.</div>
    <div style="font-size:12.5px;color:var(--text3);margin-top:12px;text-align:center;line-height:1.7">
      New? Sign in with any email + <strong style="font-family:'JetBrains Mono',monospace;color:var(--green)">student123</strong><br>
      <span style="cursor:pointer;color:var(--amber);font-weight:700" onclick="closeModal('loginModal');openModal('instructorApplyModal')">Apply to become an Instructor →</span>
    </div>
    <div class="modal-actions">
      <button class="mbtn-s" onclick="closeModal('loginModal')">Cancel</button>
      <button class="mbtn-p" onclick="doLogin()">Sign In</button>
    </div>
  </div>
</div>

<!-- ADMIN CONFIRM -->
<div class="modal-overlay" id="adminConfirmModal">
  <div class="modal" style="max-width:360px">
    <div style="text-align:center;font-size:32px;margin-bottom:14px">🔐</div>
    <h3 style="text-align:center">Admin Verification</h3>
    <div style="font-size:13px;color:var(--text3);text-align:center;margin-bottom:4px">Enter your admin password to continue</div>
    <label>Admin Password</label>
    <input type="password" id="adminPass" placeholder="••••••••" onkeydown="if(event.key==='Enter')doAdminConfirm()">
    <div class="err-msg" id="adminError">Incorrect password. Try again.</div>
    <div class="modal-actions">
      <button class="mbtn-s" onclick="closeModal('adminConfirmModal')">Cancel</button>
      <button class="mbtn-p" onclick="doAdminConfirm()">Verify</button>
    </div>
  </div>
</div>

<!-- BECOME INSTRUCTOR -->
<div class="modal-overlay" id="instructorApplyModal">
  <div class="modal">
    <h3>🎓 Apply to Become an Instructor</h3>
    <p style="font-size:13px;color:var(--text2);margin-bottom:16px;line-height:1.6">Your application will be reviewed. Approved instructors can create and manage courses.</p>
    <label>Full Name</label><input type="text" id="appName" placeholder="Your full name">
    <label>Email Address</label><input type="email" id="appEmail" placeholder="your@email.com">
    <label>LinkedIn / Portfolio</label><input type="text" id="appLinkedin" placeholder="https://linkedin.com/in/...">
    <label>Certifications / Expertise</label><input type="text" id="appCerts" placeholder="e.g. AWS SAA, GCP ACE, AZ-104">
    <label>Why do you want to teach?</label><textarea id="appWhy" placeholder="Share your background and motivation..."></textarea>
    <div id="appSuccess" style="display:none">
      <div class="success-screen">
        <div class="succ-ico">📧</div>
        <h3>Application Submitted!</h3>
        <p>Your application has been received and is under review. You'll be notified once a decision is made.</p>
      </div>
    </div>
    <div class="modal-actions" id="appActions">
      <button class="mbtn-s" onclick="closeModal('instructorApplyModal')">Cancel</button>
      <button class="mbtn-p" onclick="submitInstructorApp()">Submit Application</button>
    </div>
  </div>
</div>

<!-- ADD COURSE -->
<div class="modal-overlay" id="addCourseModal">
  <div class="modal">
    <h3>New Course</h3>
    <label>Certification ID</label><input type="text" id="nc-id" placeholder="e.g. SAA-C03, AZ-104, N+">
    <label>Course Name</label><input type="text" id="nc-name" placeholder="Full course title">
    <label>Provider</label>
    <select id="nc-provider"><option value="AWS">Amazon AWS</option><option value="GCP">Google Cloud</option><option value="Azure">Microsoft Azure</option><option value="M365">Microsoft 365</option><option value="CompTIA">CompTIA</option><option value="Other">Other</option></select>
    <label>Level</label>
    <select id="nc-level"><option>Fundamentals</option><option>Associate</option><option>Professional</option><option>Expert</option><option>Specialty</option></select>
    <label>Description</label><textarea id="nc-desc" placeholder="Course overview..."></textarea>
    <label>Duration</label><input type="text" id="nc-dur" placeholder="e.g. 40 hours">
    <div class="modal-actions">
      <button class="mbtn-s" onclick="closeModal('addCourseModal')">Cancel</button>
      <button class="mbtn-p" onclick="addCourse()">Create</button>
    </div>
  </div>
</div>

<!-- ADD MODULE -->
<div class="modal-overlay" id="addModuleModal">
  <div class="modal">
    <h3>New Module</h3>
    <label>Module Title</label><input type="text" id="nm-title" placeholder="e.g. Networking & Security">
    <div class="modal-actions">
      <button class="mbtn-s" onclick="closeModal('addModuleModal')">Cancel</button>
      <button class="mbtn-p" onclick="addModule()">Add</button>
    </div>
  </div>
</div>

<!-- ADD PAGE -->
<div class="modal-overlay" id="addPageModal">
  <div class="modal">
    <h3>Add Content</h3>
    <label>Title</label><input type="text" id="ap-title" placeholder="e.g. Introduction to VPCs">
    <label>Type</label>
    <select id="ap-type"><option value="doc">📄 Documentation</option><option value="lab">🧪 Hands-on Lab</option><option value="video">▶ Video Lesson</option></select>
    <label>Duration</label><input type="text" id="ap-dur" placeholder="e.g. 20 min">
    <label>Video URL (optional)</label><input type="text" id="ap-url" placeholder="https://youtube.com/...">
    <div class="modal-actions">
      <button class="mbtn-s" onclick="closeModal('addPageModal')">Cancel</button>
      <button class="mbtn-p" onclick="addPage()">Create</button>
    </div>
  </div>
</div>

<!-- VIDEO -->
<div class="modal-overlay" id="addVideoModal">
  <div class="modal">
    <h3>Embed Video</h3>
    <label>YouTube URL</label><input type="text" id="vb-url" placeholder="https://youtube.com/watch?v=...">
    <label>Caption</label><input type="text" id="vb-cap" placeholder="Optional caption">
    <div class="modal-actions">
      <button class="mbtn-s" onclick="closeModal('addVideoModal')">Cancel</button>
      <button class="mbtn-p" onclick="commitVideo()">Embed</button>
    </div>
  </div>
</div>

<!-- IMAGE -->
<div class="modal-overlay" id="addImageModal">
  <div class="modal">
    <h3>Add Image</h3>
    <label>Image URL</label><input type="text" id="ib-url" placeholder="https://...">
    <label>Caption</label><input type="text" id="ib-cap" placeholder="Optional caption">
    <div class="modal-actions">
      <button class="mbtn-s" onclick="closeModal('addImageModal')">Cancel</button>
      <button class="mbtn-p" onclick="commitImage()">Add</button>
    </div>
  </div>
</div>

<!-- LINK -->
<div class="modal-overlay" id="addLinkModal">
  <div class="modal">
    <h3>Add Link</h3>
    <label>URL</label><input type="text" id="lb-url" placeholder="https://...">
    <label>Title</label><input type="text" id="lb-title" placeholder="Link title">
    <label>Description</label><input type="text" id="lb-desc" placeholder="Brief description">
    <div class="modal-actions">
      <button class="mbtn-s" onclick="closeModal('addLinkModal')">Cancel</button>
      <button class="mbtn-p" onclick="commitLink()">Add</button>
    </div>
  </div>
</div>

<!-- ADD USER -->
<div class="modal-overlay" id="addUserModal">
  <div class="modal">
    <h3>Add User</h3>
    <label>Full Name</label><input type="text" id="au-name" placeholder="Full name">
    <label>Email</label><input type="email" id="au-email" placeholder="user@example.com">
    <label>Role</label>
    <select id="au-role"><option value="student">Student</option><option value="instructor">Instructor</option><option value="admin">Admin</option></select>
    <div class="modal-actions">
      <button class="mbtn-s" onclick="closeModal('addUserModal')">Cancel</button>
      <button class="mbtn-p" onclick="addUser()">Add</button>
    </div>
  </div>
</div>

<script>
// ════════════════════════════════════════════════
//   CONSTANTS
// ════════════════════════════════════════════════
const ADMIN_EMAIL = 'savi.toy@codethebox.dev';
const ADMIN_PASS  = 'ctb@Admin2024!';

// ════════════════════════════════════════════════
//   STATE — with localStorage persistence
// ════════════════════════════════════════════════
function loadState() {
  try {
    const saved = sessionStorage.getItem('ctb_session');
    if (saved) {
      const s = JSON.parse(saved);
      return s;
    }
  } catch(e){}
  return null;
}
function saveSession() {
  if (S.user) {
    try { sessionStorage.setItem('ctb_session', JSON.stringify({ user:S.user, role:S.role })); } catch(e){}
  } else {
    sessionStorage.removeItem('ctb_session');
  }
}

// Per-user progress stored in localStorage keyed by email
function getProgress(email) {
  try {
    const key = `ctb_progress_${email}`;
    const raw = localStorage.getItem(key);
    return raw ? JSON.parse(raw) : {};
  } catch(e) { return {}; }
}
function saveProgress(email, prog) {
  try {
    const key = `ctb_progress_${email}`;
    localStorage.setItem(key, JSON.stringify(prog));
  } catch(e){}
}

let S = {
  user: null,
  role: 'guest',
  editMode: false,
  curCourseId: null,
  curPageKey: null,
  addingToMod: null,
  filterProvider: 'all',
  filterLevel: 'all',
  progress: {}, // { 'courseId/pageKey': true }
  currentView: 'home',

  instructorRequests: [
    { id:1, name:'Kamonwan Phetcharat', email:'kamonwan@example.com', linkedin:'linkedin.com/in/kamonwan', certs:'AWS SAA, Azure AZ-104', why:'5 years as cloud architect, want to give back.', status:'pending', date:'2026-02-20' },
    { id:2, name:'Nuttapong Srisuk', email:'nutt@example.com', linkedin:'linkedin.com/in/nutt', certs:'CompTIA A+, Network+, Security+', why:'IT trainer with 3 years experience.', status:'approved', date:'2026-02-15' },
  ],

  users: [
    { id:1, name:'Portal Admin', email:ADMIN_EMAIL, role:'admin', joined:'2025-01-01' },
    { id:2, name:'Kamonwan P.', email:'kamonwan@example.com', role:'instructor', joined:'2026-02-15' },
    { id:3, name:'Nuttapong S.', email:'nutt@example.com', role:'student', joined:'2026-01-10' },
  ],

  courses: [
    { id:'SAA-C03', name:'AWS Solutions Architect Associate', provider:'AWS', level:'Associate', desc:'Design and deploy scalable, highly available systems on AWS. Covers EC2, S3, VPC, RDS, IAM, and architecture patterns.', duration:'45 hours', modules:[
      { title:'AWS Core Services', col:'#FF9900', pages:[
        { title:'EC2 & Compute', type:'doc', dur:'20 min', url:'', blocks:[
          {t:'heading',c:'Amazon EC2 – Elastic Compute Cloud'},
          {t:'text',c:'EC2 provides resizable compute capacity in the cloud. Choose from 500+ instance types optimized for compute, memory, storage, and GPU workloads.'},
          {t:'note',c:'For SAA-C03 exam: know the difference between On-Demand, Reserved, Spot, and Dedicated instance pricing models.'},
          {t:'code',c:'# Launch an EC2 instance\naws ec2 run-instances \\\n  --image-id ami-0abcdef1234567890 \\\n  --instance-type t3.micro \\\n  --key-name MyKeyPair \\\n  --security-group-ids sg-12345678'},
        ]},
        { title:'S3 & Object Storage', type:'doc', dur:'18 min', url:'', blocks:[
          {t:'heading',c:'Amazon S3 – Simple Storage Service'},
          {t:'text',c:'S3 provides object storage with 99.999999999% (11 9s) durability. Objects range from 0 bytes to 5TB.'},
          {t:'warning',c:'S3 bucket names must be globally unique across ALL AWS accounts. Plan your naming convention carefully.'},
        ]},
        { title:'Lab: Deploy 3-Tier Architecture', type:'lab', dur:'90 min', url:'', blocks:[
          {t:'lab-meta',duration:'90 min',difficulty:'Intermediate',points:150},
          {t:'heading',c:'Objectives'},
          {t:'text',c:'Deploy a highly available 3-tier web app using EC2 (web/app tier), RDS (database), S3 (static assets), and an Application Load Balancer.'},
          {t:'step',n:1,title:'Create VPC and Subnets',c:'Create a VPC (CIDR 10.0.0.0/16). Add 2 public subnets and 2 private subnets across 2 AZs.'},
          {t:'step',n:2,title:'Launch EC2 Instances',c:'Deploy 2 t3.micro instances (Amazon Linux 2023) in public subnets with Apache installed via User Data.'},
          {t:'step',n:3,title:'Configure Load Balancer',c:'Create an Application Load Balancer in public subnets with a target group pointing to your EC2 instances.'},
          {t:'step',n:4,title:'Set Up RDS',c:'Deploy RDS MySQL 8.0 (db.t3.micro) in private subnet group with Multi-AZ enabled.'},
        ]},
      ]},
      { title:'Networking & Security', col:'#FF6600', pages:[
        { title:'VPC Deep Dive', type:'doc', dur:'25 min', url:'', blocks:[
          {t:'heading',c:'Amazon VPC Architecture'},
          {t:'text',c:'A VPC is a logically isolated section of the AWS Cloud. Each VPC spans all AZs in a region and can be subdivided into subnets per AZ.'},
          {t:'code',c:'# Create VPC\naws ec2 create-vpc --cidr-block 10.0.0.0/16\n# Create and attach Internet Gateway\naws ec2 create-internet-gateway\naws ec2 attach-internet-gateway --internet-gateway-id igw-xxx --vpc-id vpc-xxx'},
        ]},
      ]},
    ]},
    { id:'CLF-C02', name:'AWS Cloud Practitioner', provider:'AWS', level:'Fundamentals', desc:'Entry-level certification covering fundamental AWS Cloud concepts, services, and terminology for any role.', duration:'12 hours', modules:[
      { title:'Cloud Fundamentals', col:'#FF9900', pages:[
        { title:'What is AWS?', type:'doc', dur:'15 min', url:'', blocks:[{t:'heading',c:'Amazon Web Services Overview'},{t:'text',c:'AWS is the world\'s most comprehensive cloud platform, offering 200+ fully featured services from data centers globally since 2006.'}]},
        { title:'AWS Global Infrastructure', type:'video', dur:'12 min', url:'https://www.youtube.com/embed/a9__D53WsUs', blocks:[{t:'heading',c:'AWS Regions, AZs, and Edge Locations'},{t:'video',url:'https://www.youtube.com/embed/a9__D53WsUs',cap:'AWS Global Infrastructure Overview'},{t:'text',c:'AWS operates 31 regions, 99 Availability Zones, and 400+ Points of Presence worldwide.'}]},
      ]},
    ]},
    { id:'ACE', name:'Google Cloud Associate Engineer', provider:'GCP', level:'Associate', desc:'Deploy applications, monitor operations, and manage enterprise solutions on Google Cloud Platform.', duration:'40 hours', modules:[
      { title:'GCP Core Infrastructure', col:'#4285F4', pages:[
        { title:'Compute Engine & GKE', type:'doc', dur:'22 min', url:'', blocks:[
          {t:'heading',c:'Google Compute Engine & Kubernetes Engine'},
          {t:'text',c:'Compute Engine delivers configurable VMs running in Google\'s data centers. GKE provides managed Kubernetes for containerized workloads.'},
          {t:'tip',c:'For the ACE exam, know when to use Compute Engine vs App Engine vs Cloud Run vs GKE — this distinction is heavily tested.'},
        ]},
        { title:'Lab: Deploy on GKE', type:'lab', dur:'60 min', url:'', blocks:[
          {t:'lab-meta',duration:'60 min',difficulty:'Intermediate',points:100},
          {t:'heading',c:'Deploy a Containerized App to GKE'},
          {t:'step',n:1,title:'Create GKE Cluster',c:'gcloud container clusters create my-cluster --zone us-central1-a --num-nodes=3'},
          {t:'step',n:2,title:'Deploy Application',c:'kubectl create deployment hello-app --image=gcr.io/google-samples/hello-app:1.0'},
          {t:'step',n:3,title:'Expose Service',c:'kubectl expose deployment hello-app --type=LoadBalancer --port 80 --target-port 8080'},
        ]},
      ]},
    ]},
    { id:'PCA', name:'Professional Cloud Architect', provider:'GCP', level:'Professional', desc:'Design, develop, and manage robust, secure, scalable, and highly available solutions on GCP.', duration:'60 hours', modules:[
      { title:'Solution Design', col:'#1A73E8', pages:[
        { title:'GCP Architecture Patterns', type:'doc', dur:'30 min', url:'', blocks:[{t:'heading',c:'GCP Well-Architected Framework'},{t:'text',c:'Google Cloud WAF covers operational excellence, security, reliability, performance efficiency, and cost optimization across all 5 pillars.'}]},
      ]},
    ]},
    { id:'AZ-900', name:'Azure Fundamentals', provider:'Azure', level:'Fundamentals', desc:'Foundation-level knowledge of cloud services and Microsoft Azure — perfect for non-technical roles.', duration:'8 hours', modules:[
      { title:'Cloud Concepts', col:'#0078D4', pages:[
        { title:'What is Cloud Computing?', type:'doc', dur:'10 min', url:'', blocks:[
          {t:'heading',c:'Cloud Computing Fundamentals'},
          {t:'text',c:'Cloud computing delivers services over the internet — servers, storage, databases, networking, software, analytics — enabling faster innovation and flexible resources.'},
          {t:'note',c:'AZ-900 covers three cloud models: Public, Private, Hybrid — and three service models: IaaS, PaaS, SaaS.'},
        ]},
        { title:'Azure Portal Tour', type:'video', dur:'15 min', url:'https://www.youtube.com/embed/NKEFWyIE3MU', blocks:[
          {t:'heading',c:'Navigating the Azure Portal'},
          {t:'video',url:'https://www.youtube.com/embed/NKEFWyIE3MU',cap:'Azure Portal Overview — Microsoft Learn'},
          {t:'text',c:'The Azure Portal is a web-based console for managing Azure resources. Familiarize yourself with the key navigation elements before your exam.'},
        ]},
        { title:'Lab: Create Your First VM', type:'lab', dur:'30 min', url:'', blocks:[
          {t:'lab-meta',duration:'30 min',difficulty:'Beginner',points:50},
          {t:'step',n:1,title:'Sign in to Azure Portal',c:'Navigate to portal.azure.com and sign in with your Microsoft account or Azure free trial.'},
          {t:'step',n:2,title:'Create Resource Group',c:'Click Resource Groups → + Create → name it rg-az900-lab → select East US region → Review + Create.'},
          {t:'step',n:3,title:'Deploy VM',c:'Search Virtual Machines → + Create → select Windows Server 2022 → B2s size → deploy to your resource group.'},
        ]},
      ]},
    ]},
    { id:'AZ-104', name:'Azure Administrator', provider:'Azure', level:'Associate', desc:'Implement, manage, and monitor Azure infrastructure — identity, storage, compute, and virtual networks.', duration:'40 hours', modules:[
      { title:'Identity & Access', col:'#0078D4', pages:[
        { title:'Microsoft Entra ID', type:'doc', dur:'20 min', url:'', blocks:[
          {t:'heading',c:'Microsoft Entra ID (formerly Azure AD)'},
          {t:'text',c:'Entra ID is Microsoft\'s cloud-based identity and access management service, central to the AZ-104 exam.'},
          {t:'warning',c:'Know the difference between Entra ID P1 (Conditional Access) and P2 (PIM, Identity Protection) licensing tiers.'},
        ]},
        { title:'Lab: Configure RBAC', type:'lab', dur:'45 min', url:'', blocks:[
          {t:'lab-meta',duration:'45 min',difficulty:'Intermediate',points:75},
          {t:'step',n:1,title:'Create Test Users',c:'Go to Entra ID → Users → + New user. Create two users: testadmin and testviewer.'},
          {t:'step',n:2,title:'Assign Roles',c:'Navigate to a resource group → Access Control (IAM) → + Add role assignment → assign Contributor to testadmin, Reader to testviewer.'},
          {t:'step',n:3,title:'Verify Permissions',c:'Sign in as each test user and verify they can/cannot perform expected actions based on their assigned role.'},
        ]},
      ]},
    ]},
    { id:'AZ-305', name:'Azure Solutions Architect Expert', provider:'Azure', level:'Expert', desc:'Design and implement cloud and hybrid solutions on Azure — compute, network, storage, and security.', duration:'56 hours', modules:[
      { title:'Architecture Design', col:'#0066CC', pages:[
        { title:'Azure Well-Architected Framework', type:'doc', dur:'28 min', url:'', blocks:[{t:'heading',c:'Azure WAF — 5 Pillars'},{t:'text',c:'Reliability, Security, Cost Optimization, Operational Excellence, Performance Efficiency. Every design decision must balance these pillars.'},{t:'tip',c:'AZ-305 frequently tests trade-offs between pillars — e.g. higher reliability often increases cost.'}]},
      ]},
    ]},
    { id:'MS-900', name:'Microsoft 365 Fundamentals', provider:'M365', level:'Fundamentals', desc:'Foundational knowledge of cloud-based Microsoft 365 productivity, collaboration, and security.', duration:'10 hours', modules:[
      { title:'M365 Core Services', col:'#D83B01', pages:[
        { title:'Microsoft 365 Overview', type:'doc', dur:'15 min', url:'', blocks:[
          {t:'heading',c:'Microsoft 365 Platform'},
          {t:'text',c:'M365 combines Office apps (Word, Excel, PowerPoint, Outlook), Teams, SharePoint, Exchange, and cloud security in a unified subscription.'},
          {t:'card',h:'Key Licensing Tiers',c:'Business Basic, Business Standard, Business Premium, E3, E5 — know the feature differences for MS-900.'},
        ]},
      ]},
    ]},
    { id:'MS-700', name:'Managing Microsoft Teams', provider:'M365', level:'Associate', desc:'Configure and manage Microsoft Teams for collaboration, meetings, calling, and Teams apps.', duration:'35 hours', modules:[
      { title:'Teams Administration', col:'#D83B01', pages:[
        { title:'Teams Architecture', type:'doc', dur:'18 min', url:'', blocks:[{t:'heading',c:'Microsoft Teams Architecture'},{t:'text',c:'Teams is built on Microsoft 365 Groups, SharePoint Online, Exchange Online, and Azure AD. Understanding the underlying services is essential for MS-700.'}]},
      ]},
    ]},
    { id:'CompTIA-A+', name:'CompTIA A+ Core 1 & 2', provider:'CompTIA', level:'Fundamentals', desc:'Industry-standard IT certification covering hardware, networking, troubleshooting, and operating systems.', duration:'25 hours', modules:[
      { title:'Hardware & Networking', col:'#C8202A', pages:[
        { title:'PC Components', type:'doc', dur:'20 min', url:'', blocks:[
          {t:'heading',c:'Core Hardware Components'},
          {t:'text',c:'A+ covers CPUs, RAM (DDR4/DDR5), storage (NVMe, SATA, HDD), motherboards, PSUs, and expansion cards. Know all physical connectors and form factors.'},
          {t:'note',c:'CompTIA A+ requires passing both 220-1101 (Core 1) AND 220-1102 (Core 2).'},
        ]},
      ]},
    ]},
    { id:'CompTIA-Sec+', name:'CompTIA Security+', provider:'CompTIA', level:'Associate', desc:'Globally trusted vendor-neutral certification validating core security skills. DoD 8570 approved.', duration:'30 hours', modules:[
      { title:'Threats & Vulnerabilities', col:'#C8202A', pages:[
        { title:'Malware & Attack Types', type:'doc', dur:'18 min', url:'', blocks:[
          {t:'heading',c:'Common Malware & Attack Types'},
          {t:'text',c:'Ransomware encrypts data for payment. Trojans disguise as legitimate software. Rootkits hide malicious activity. Spyware monitors user activity covertly.'},
          {t:'danger',c:'Zero-day exploits target unknown vulnerabilities — no patch exists. Mitigation relies on anomaly detection and behavior analysis.'},
        ]},
        { title:'Lab: Network Scanning', type:'lab', dur:'45 min', url:'', blocks:[
          {t:'lab-meta',duration:'45 min',difficulty:'Intermediate',points:75},
          {t:'step',n:1,title:'Install Nmap',c:'Linux: sudo apt install nmap | Windows: download from nmap.org'},
          {t:'step',n:2,title:'Run Basic Scan',c:'nmap -sV 192.168.1.0/24 — discover hosts and services on your local network.'},
          {t:'step',n:3,title:'Analyze Results',c:'Document open ports, running services, and OS fingerprint. Identify unexpected exposures.'},
        ]},
      ]},
    ]},
    { id:'CKA', name:'Certified Kubernetes Administrator', provider:'Other', level:'Professional', desc:'Demonstrate competency in Kubernetes administration — installation, networking, storage, and security.', duration:'50 hours', modules:[
      { title:'Kubernetes Core', col:'#326CE5', pages:[
        { title:'Pods & Workloads', type:'doc', dur:'25 min', url:'', blocks:[
          {t:'heading',c:'Kubernetes Workload Types'},
          {t:'text',c:'Pods are the smallest deployable unit. Deployments manage stateless workloads, StatefulSets for stateful apps, DaemonSets for node-level agents.'},
          {t:'code',c:'# Create a deployment\nkubectl create deployment nginx --image=nginx --replicas=3\n\n# Expose via LoadBalancer service\nkubectl expose deployment nginx --port=80 --type=LoadBalancer\n\n# Check status\nkubectl get pods,svc -o wide'},
        ]},
      ]},
    ]},
  ],
};

// ════════════════════════════════════════════════
//   PROVIDER CONFIG
// ════════════════════════════════════════════════
const PROV = {
  AWS:     { color:'#FF9900', bg:'rgba(255,153,0,0.1)',   label:'Amazon AWS',   short:'AWS'   },
  GCP:     { color:'#4285F4', bg:'rgba(66,133,244,0.1)',  label:'Google Cloud', short:'GCP'   },
  Azure:   { color:'#0078D4', bg:'rgba(0,120,212,0.1)',   label:'Microsoft Azure', short:'Azure' },
  M365:    { color:'#D83B01', bg:'rgba(216,59,1,0.1)',    label:'Microsoft 365',short:'M365'  },
  CompTIA: { color:'#C8202A', bg:'rgba(200,32,42,0.1)',   label:'CompTIA',      short:'CompTIA'},
  Other:   { color:'#8B5CF6', bg:'rgba(139,92,246,0.1)',  label:'Other/CNCF',   short:'Other' },
};

const PROV_LOGOS = [
  { key:'AWS',  label:'Amazon AWS',    color:'#FF9900', icon:'☁',  bg:'rgba(255,153,0,0.08)' },
  { key:'GCP',  label:'Google Cloud',  color:'#4285F4', icon:'◎',  bg:'rgba(66,133,244,0.08)' },
  { key:'Azure',label:'Microsoft Azure',color:'#0078D4',icon:'⬡',  bg:'rgba(0,120,212,0.08)' },
  { key:'M365', label:'Microsoft 365', color:'#D83B01', icon:'⊞',  bg:'rgba(216,59,1,0.08)' },
  { key:'CompTIA',label:'CompTIA',     color:'#C8202A', icon:'✦',  bg:'rgba(200,32,42,0.08)' },
  { key:'Other',label:'Linux/K8s/CNCF',color:'#8B5CF6', icon:'⬡', bg:'rgba(139,92,246,0.08)' },
];

// ════════════════════════════════════════════════
//   THEME
// ════════════════════════════════════════════════
let _theme = localStorage.getItem('ctb_theme') || 'light';
function applyTheme(t) {
  _theme = t;
  document.documentElement.setAttribute('data-theme', t);
  document.getElementById('themeBtn').textContent = t === 'dark' ? '☀️' : '🌙';
  localStorage.setItem('ctb_theme', t);
}
function toggleTheme() { applyTheme(_theme === 'dark' ? 'light' : 'dark'); }
applyTheme(_theme);

// ════════════════════════════════════════════════
//   AUTH
// ════════════════════════════════════════════════
function initSession() {
  const saved = loadState();
  if (saved) {
    S.user = saved.user;
    S.role = saved.role;
    if (S.user) S.progress = getProgress(S.user.email);
    if (S.role === 'admin') { S.editMode = false; } // don't auto-enable edit on restore
  }
}

function doLogin() {
  const email = document.getElementById('loginEmail').value.trim().toLowerCase();
  const pass  = document.getElementById('loginPass').value;
  const errEl = document.getElementById('loginError');
  errEl.classList.remove('show');

  if (!email || !pass) { errEl.textContent='Please enter email and password.'; errEl.classList.add('show'); return; }

  if (email === ADMIN_EMAIL.toLowerCase()) {
    S._pendingAdminLogin = true;
    closeModal('loginModal');
    document.getElementById('adminPass').value = '';
    document.getElementById('adminError').classList.remove('show');
    openModal('adminConfirmModal');
    return;
  }

  // Any email + 'student123' = student
  if (pass === 'student123') {
    const name = email.split('@')[0].replace(/[^a-zA-Z0-9]/g,' ').trim() || 'Student';
    S.user = { name: name.charAt(0).toUpperCase() + name.slice(1), email, role:'student' };
    S.role = 'student';
    S.progress = getProgress(email);
    closeModal('loginModal');
    saveSession();
    updateUI();
    showToast('Welcome! Signed in as Student 📖', 'green');
    return;
  }

  errEl.textContent = 'Invalid credentials. Try password: student123';
  errEl.classList.add('show');
}

function doAdminConfirm() {
  const pass  = document.getElementById('adminPass').value;
  const errEl = document.getElementById('adminError');
  errEl.classList.remove('show');

  if (pass === ADMIN_PASS) {
    S.user = { name:'Admin', email:ADMIN_EMAIL, role:'admin' };
    S.role = 'admin';
    S.progress = getProgress(ADMIN_EMAIL);
    closeModal('adminConfirmModal');
    saveSession();
    updateUI();
    showToast('Admin access granted 👑', 'amber');
  } else {
    errEl.classList.add('show');
  }
}

function logout() {
  S.user = null;
  S.role = 'guest';
  S.editMode = false;
  S.progress = {};
  document.body.classList.remove('edit-mode');
  sessionStorage.removeItem('ctb_session');
  closeUserMenu();
  updateUI();
  showToast('Signed out', 'cyan');
  showView('home');
}

function updateUI() {
  const area    = document.getElementById('userArea');
  const umSign  = document.getElementById('umSignIn');
  const umInst  = document.getElementById('umInstructor');
  const umManag = document.getElementById('umManage');
  const umLogout= document.getElementById('umLogout');
  const heroBtn = document.getElementById('heroSignInBtn');

  document.getElementById('umName').textContent  = S.user ? S.user.name : 'Guest';
  document.getElementById('umEmail').textContent = S.user ? S.user.email : 'Not signed in';

  if (!S.user) {
    area.innerHTML = `<button class="signin-btn" onclick="openModal('loginModal')">Sign In</button>`;
    umSign.style.display  = '';
    umInst.style.display  = '';
    umManag.style.display = 'none';
    umLogout.style.display= 'none';
    if (heroBtn) heroBtn.style.display = '';
  } else {
    const initials = S.user.name.split(' ').map(w=>w[0]||'').join('').substring(0,2).toUpperCase();
    const roleIcon = {admin:'👑',instructor:'🎓',student:'📖'}[S.role]||'';
    const roleLabel = S.role.charAt(0).toUpperCase()+S.role.slice(1);
    area.innerHTML = `<div class="user-chip" onclick="toggleUserMenu(event)">
      <div class="user-avatar ua-${S.role[0]}">${initials}</div>
      <div><div class="uc-name">${S.user.name.split(' ')[0]}</div><div class="uc-role">${roleIcon} ${roleLabel}</div></div>
      <div class="role-dot dot-${S.role}"></div>
    </div>`;
    umSign.style.display  = 'none';
    umInst.style.display  = S.role === 'student' ? '' : 'none';
    umManag.style.display = S.role === 'admin' ? '' : 'none';
    umLogout.style.display= '';
    if (heroBtn) heroBtn.style.display = 'none';
  }
}

function toggleUserMenu(e) {
  e.stopPropagation();
  const r = e.currentTarget.getBoundingClientRect();
  const m = document.getElementById('userMenu');
  m.style.top   = (r.bottom + 8) + 'px';
  m.style.right = (window.innerWidth - r.right) + 'px';
  m.classList.toggle('open');
}
function closeUserMenu() { document.getElementById('userMenu').classList.remove('open'); }
document.addEventListener('click', closeUserMenu);

// ════════════════════════════════════════════════
//   INSTRUCTOR APPLICATION
// ════════════════════════════════════════════════
function submitInstructorApp() {
  const name  = document.getElementById('appName').value.trim();
  const email = document.getElementById('appEmail').value.trim();
  if (!name || !email) { showToast('Name and email required','amber'); return; }
  S.instructorRequests.push({
    id:Date.now(), name, email,
    linkedin:document.getElementById('appLinkedin').value.trim(),
    certs:document.getElementById('appCerts').value.trim(),
    why:document.getElementById('appWhy').value.trim(),
    status:'pending', date:new Date().toISOString().split('T')[0]
  });
  document.getElementById('appActions').style.display='none';
  document.getElementById('appSuccess').style.display='block';
  showToast('Application submitted! ✓','green');
  setTimeout(()=>{
    closeModal('instructorApplyModal');
    document.getElementById('appActions').style.display='flex';
    document.getElementById('appSuccess').style.display='none';
  },3200);
}

// ════════════════════════════════════════════════
//   VIEWS
// ════════════════════════════════════════════════
function showView(v) {
  S.currentView = v;
  ['homeView','catalogView','courseView','managerView'].forEach(id=>{
    const el = document.getElementById(id);
    el.classList.remove('active');
    el.style.display = 'none';
  });
  document.querySelectorAll('.hdr-btn').forEach(b=>b.classList.remove('active'));

  if (v==='home') {
    document.getElementById('homeView').classList.add('active');
    document.getElementById('homeView').style.display = 'block';
    document.getElementById('navHome').classList.add('active');
    document.getElementById('navCourse').style.display='none';
    renderProviderLogos();
    document.getElementById('statCourses').textContent = S.courses.length+'+';
  }
  else if (v==='catalog') {
    document.getElementById('catalogView').classList.add('active');
    document.getElementById('catalogView').style.display = 'block';
    document.getElementById('navCatalog').classList.add('active');
    document.getElementById('navCourse').style.display='none';
    renderCatalog();
  }
  else if (v==='course') {
    document.getElementById('courseView').classList.add('active');
    document.getElementById('courseView').style.display = 'flex';
    document.getElementById('navCourse').style.display='';
    document.getElementById('navCourse').classList.add('active');
    renderCourseView();
  }
  else if (v==='manager') {
    if (S.role!=='admin') { showToast('Admin access required','amber'); return; }
    document.getElementById('managerView').classList.add('active');
    document.getElementById('managerView').style.display = 'block';
    renderManager();
  }
}

// ════════════════════════════════════════════════
//   HOME
// ════════════════════════════════════════════════
function renderProviderLogos() {
  document.getElementById('providerLogoRow').innerHTML = PROV_LOGOS.map(p=>`
    <div class="prov-logo-pill" onclick="filterProvider('${p.key}',null);showView('catalog')" style="cursor:pointer;border-color:${p.color}22">
      <div class="prov-icon" style="background:${p.bg};color:${p.color}">${p.icon}</div>
      <span style="color:${p.color}">${p.label}</span>
      <span style="font-size:11px;color:var(--text3);font-family:'JetBrains Mono',monospace">${S.courses.filter(c=>c.provider===p.key).length}</span>
    </div>`).join('');
}

// ════════════════════════════════════════════════
//   CATALOG
// ════════════════════════════════════════════════
let _pF='all', _lF='all';

function renderCatalog() {
  const filtered = S.courses.filter(c=>(_pF==='all'||c.provider===_pF)&&(_lF==='all'||c.level===_lF));
  document.getElementById('coursesGrid').innerHTML = filtered.map(c=>{
    const p = PROV[c.provider]||PROV.Other;
    const pct = getCourseProgress(c);
    const showPct = !!S.user;
    const totalLabs = c.modules.reduce((s,m)=>s+m.pages.filter(pg=>pg.type==='lab').length,0);
    return `<div class="course-card" onclick="openCourse('${c.id}')">
      <div class="cc-accent-bar" style="background:linear-gradient(90deg,${p.color},${p.color}44)"></div>
      <div class="cc-top">
        <div class="cc-prov-row">
          <div class="prov-badge" style="color:${p.color};background:${p.bg}">
            <span style="width:7px;height:7px;border-radius:50%;background:${p.color};display:inline-block"></span>
            ${p.short} · ${c.id}
          </div>
          <span class="lv-badge lv-${c.level}">${c.level}</span>
        </div>
        <h3>${c.name}</h3>
        <p>${c.desc}</p>
      </div>
      <div class="cc-meta">
        <span class="cm"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>${c.modules.length} modules</span>
        <span class="cm"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 3H5a2 2 0 00-2 2v4m6-6h10a2 2 0 012 2v4M9 3v18m0 0h10a2 2 0 002-2V9M9 21H5a2 2 0 01-2-2V9m0 0h18"/></svg>${totalLabs} labs</span>
        <span class="cm"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>${c.duration}</span>
        ${showPct ? `<div class="cc-prog-wrap">
          <div class="cc-prog-bar"><div class="cc-prog-fill" style="width:${pct}%;background:${p.color}"></div></div>
          <span class="cc-prog-pct" style="color:${p.color}">${pct}%</span>
        </div>` : ''}
      </div>
      <div class="cc-footer">
        <button class="open-btn" style="color:${p.color}">
          ${(showPct && pct>0)?'Continue':'Start'}
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
        </button>
        <span class="cert-id">${c.id}</span>
      </div>
    </div>`;
  }).join('');
}

function filterProvider(p, btn) {
  _pF = p;
  if (btn) {
    document.querySelectorAll('.ptab').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
  } else {
    document.querySelectorAll('.ptab').forEach(b=>{ if(b.textContent.includes(p)||p==='all') b.classList.add('active'); else b.classList.remove('active'); });
  }
  renderCatalog();
}
function filterLevel(l, btn) {
  _lF = l;
  document.querySelectorAll('.lvl-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  renderCatalog();
}
function openCourse(id) {
  S.curCourseId = id;
  const c = S.courses.find(x=>x.id===id);
  if (c?.modules[0]?.pages[0]) S.curPageKey='0-0';
  showView('course');
}

// ════════════════════════════════════════════════
//   PROGRESS
// ════════════════════════════════════════════════
function getPageKey(cid, pageKey) { return `${cid}::${pageKey}`; }

function isPageDone(cid, pageKey) {
  return !!S.progress[getPageKey(cid, pageKey)];
}

function markPageDone(cid, pageKey, done) {
  const k = getPageKey(cid, pageKey);
  if (done) S.progress[k] = true;
  else delete S.progress[k];
  if (S.user) saveProgress(S.user.email, S.progress);
}

function getCourseProgress(c) {
  if (!S.user) return 0;
  let total = 0, done = 0;
  c.modules.forEach((m,mi)=>m.pages.forEach((p,pi)=>{
    total++;
    if (isPageDone(c.id, `${mi}-${pi}`)) done++;
  }));
  return total===0 ? 0 : Math.round((done/total)*100);
}

// ════════════════════════════════════════════════
//   COURSE VIEW
// ════════════════════════════════════════════════
function renderCourseView() {
  const c = S.courses.find(x=>x.id===S.curCourseId);
  if (!c) return;
  const p = PROV[c.provider]||PROV.Other;
  const pct = getCourseProgress(c);

  const sbId = document.getElementById('sbId');
  sbId.textContent = c.id;
  sbId.style.color = p.color;
  sbId.style.borderColor = p.color;
  sbId.style.background = p.bg;
  document.getElementById('sbTitle').textContent = c.name;
  document.getElementById('sbProg').style.width = pct+'%';
  document.getElementById('sbProg').style.background = p.color;
  document.getElementById('sbPct').textContent = S.user ? pct+'%' : '—';

  renderModuleList(c);
  renderPageContent();
}

function renderModuleList(c) {
  const [sMi,sPi] = (S.curPageKey||'0-0').split('-').map(Number);
  const canEdit = S.role==='admin'||S.role==='instructor';

  const list = document.getElementById('moduleList');
  list.innerHTML = c.modules.map((mod,mi)=>{
    const isExp = mi===sMi;
    const subs = mod.pages.map((pg,pi)=>{
      const key=`${mi}-${pi}`;
      const isActive = key===S.curPageKey;
      const done = isPageDone(c.id, key);
      const typeIco = pg.type==='lab'
        ? `<svg class="si-ico" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 3H5a2 2 0 00-2 2v4m6-6h10a2 2 0 012 2v4M9 3v18m0 0h10a2 2 0 002-2V9M9 21H5a2 2 0 01-2-2V9m0 0h18"/></svg>`
        : pg.type==='video'
        ? `<svg class="si-ico" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"/></svg>`
        : `<svg class="si-ico" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>`;
      return `<div class="sub-item ${isActive?'active':''}" onclick="loadPage('${key}')">
        <div class="si-check ${done&&S.user?'done':''}"></div>
        ${typeIco}
        <span style="flex:1;line-height:1.35">${pg.title}</span>
        <span class="si-type si-${pg.type}">${pg.type}</span>
      </div>`;
    }).join('');
    const addBtn = canEdit ? `<div style="padding:6px 14px 10px 40px"><button onclick="event.stopPropagation();openAddPage(${mi})" style="width:100%;padding:6px;border:1px dashed var(--border2);border-radius:5px;background:transparent;color:var(--text3);font-size:11.5px;cursor:pointer;font-family:inherit;font-weight:700;transition:all 0.15s" onmouseover="this.style.color='var(--accent)';this.style.borderColor='var(--accent)'" onmouseout="this.style.color='var(--text3)';this.style.borderColor='var(--border2)'">+ Add Content</button></div>` : '';
    return `<div class="mod-item">
      <div class="mod-hdr ${isExp?'exp':''}" onclick="toggleMod(${mi},this)">
        <div class="mod-num" style="background:${mod.col}">${mi+1}</div>
        <div class="mod-title">${mod.title}</div>
        <div class="mod-cnt">${mod.pages.length}</div>
        <svg class="mod-chev" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M9 18l6-6-6-6"/></svg>
      </div>
      <div class="mod-subitems ${isExp?'open':''}" id="ms-${mi}">${subs}${addBtn}</div>
    </div>`;
  }).join('');

  if (canEdit) {
    list.innerHTML += `<div style="padding:10px 14px 4px"><button onclick="openModal('addModuleModal')" style="width:100%;padding:8px;border:1px dashed var(--border2);border-radius:6px;background:transparent;color:var(--text3);cursor:pointer;font-family:inherit;font-size:12px;font-weight:700;transition:all 0.15s" onmouseover="this.style.color='var(--accent)';this.style.borderColor='var(--accent)'" onmouseout="this.style.color='var(--text3)';this.style.borderColor='var(--border2)'">+ Add Module</button></div>`;
  }
}

function toggleMod(mi,hdrEl) {
  const sub = document.getElementById(`ms-${mi}`);
  const hdr = hdrEl||document.querySelectorAll('.mod-hdr')[mi];
  sub.classList.toggle('open');
  hdr.classList.toggle('exp');
}

function loadPage(key) {
  S.curPageKey=key;
  const c=S.courses.find(x=>x.id===S.curCourseId);
  renderModuleList(c);
  renderPageContent();
}

function getPage() {
  const c=S.courses.find(x=>x.id===S.curCourseId);
  if(!c||!S.curPageKey) return null;
  const [mi,pi]=S.curPageKey.split('-').map(Number);
  return c.modules[mi]?.pages[pi];
}

function renderPageContent() {
  const c=S.courses.find(x=>x.id===S.curCourseId);
  if(!c||!S.curPageKey) return;
  const [mi,pi]=S.curPageKey.split('-').map(Number);
  const mod=c.modules[mi]; const page=mod?.pages[pi];
  if(!page) return;
  const p=PROV[c.provider]||PROV.Other;

  const canEdit = S.role==='admin'||S.role==='instructor';
  const typeLabel={doc:'Documentation',lab:'Hands-on Lab',video:'Video Lesson'};
  const typeIcon={
    doc:`<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>`,
    lab:`<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 3H5a2 2 0 00-2 2v4m6-6h10a2 2 0 012 2v4M9 3v18m0 0h10a2 2 0 002-2V9M9 21H5a2 2 0 01-2-2V9m0 0h18"/></svg>`,
    video:`<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"/></svg>`,
  };

  const isDone = isPageDone(c.id, S.curPageKey);

  let allPages=[]; c.modules.forEach((m,mi2)=>m.pages.forEach((pg,pi2)=>allPages.push({key:`${mi2}-${pi2}`,title:pg.title})));
  const curIdx=allPages.findIndex(x=>x.key===S.curPageKey);
  const prev=allPages[curIdx-1], next=allPages[curIdx+1];

  const completeBtn = S.user
    ? `<button class="complete-btn ${isDone?'done':''}" id="completeBtnMain" onclick="togglePageComplete()">
        <svg width="16" height="16" viewBox="0 0 24 24">
          <circle cx="12" cy="12" r="10" fill="${isDone?'var(--green)':'none'}" stroke="${isDone?'var(--green)':'var(--border2)'}" stroke-width="2"/>
          <path d="M8 12l3 3 5-5" stroke="${isDone?'#fff':'var(--text3)'}" stroke-width="2.5" fill="none" stroke-linecap="round"/>
        </svg>
        ${isDone?'Completed':'Mark Complete'}
      </button>`
    : `<button class="cbtn-login" onclick="openModal('loginModal')">
        <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 3h4a2 2 0 012 2v14a2 2 0 01-2 2h-4"/><polyline points="10 17 15 12 10 7"/><line x1="15" y1="12" x2="3" y2="12"/></svg>
        Sign in to track
      </button>`;

  const editToggle = canEdit ? `
    <div class="edit-toggle-wrap ${S.editMode?'on':''}" onclick="toggleEdit(!S.editMode)" style="margin-left:8px">
      <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4z"/></svg>
      ${S.editMode?'Editing':'Edit'}
    </div>` : '';

  const becomeBanner = S.role==='student' ? `
    <div class="become-banner">
      <span class="bb-ico">🎓</span>
      <div class="bb-text"><h4>Become a codethebox Instructor</h4><p>Share your expertise — create and manage course content</p></div>
      <button class="bb-btn" onclick="openModal('instructorApplyModal')">Apply Now</button>
    </div>` : '';

  const area = document.getElementById('contentArea');
  area.innerHTML = `
    <div class="bcrumb">
      <a onclick="showView('catalog')">Catalog</a><span>›</span>
      <a onclick="showView('catalog')" style="color:${p.color}">${c.id}</a><span>›</span>
      <span>${mod.title}</span><span>›</span><span style="color:var(--text)">${page.title}</span>
    </div>
    ${becomeBanner}
    <div class="page-type-chip ptc-${page.type}">${typeIcon[page.type]} ${typeLabel[page.type]}${page.dur?` · ${page.dur}`:''}</div>
    <div class="page-hdr-row">
      <div class="page-title" id="pgTitle" ${canEdit&&S.editMode?'contenteditable="true"':''}>${page.title}</div>
      <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;flex-shrink:0">
        ${completeBtn}
        ${editToggle}
      </div>
    </div>
    <div class="blocks-container" id="blocksContainer">${page.blocks.map((b,i)=>renderBlock(b,i)).join('')}</div>
    <div class="add-block-bar">
      <span class="abl">Add block:</span>
      <button class="abb" onclick="addBlock('text')">📝 Text</button>
      <button class="abb" onclick="addBlock('heading')">📌 Heading</button>
      <button class="abb" onclick="addBlock('note')">ℹ Note</button>
      <button class="abb" onclick="addBlock('tip')">✅ Tip</button>
      <button class="abb" onclick="addBlock('warning')">⚠ Warning</button>
      <button class="abb" onclick="addBlock('danger')">🚫 Danger</button>
      <button class="abb" onclick="addBlock('code')">💻 Code</button>
      <button class="abb" onclick="addBlock('card')">🃏 Card</button>
      <button class="abb" onclick="openModal('addVideoModal')">▶ Video</button>
      <button class="abb" onclick="openModal('addImageModal')">🖼 Image</button>
      <button class="abb" onclick="openModal('addLinkModal')">🔗 Link</button>
    </div>
    <div class="page-nav">
      ${prev?`<button class="pn-btn" onclick="loadPage('${prev.key}')"><span class="pn-dir">← Previous</span><span class="pn-title">${prev.title}</span></button>`:'<div></div>'}
      ${next?`<button class="pn-btn right" onclick="loadPage('${next.key}')"><span class="pn-dir">Next →</span><span class="pn-title">${next.title}</span></button>`:'<div></div>'}
    </div>`;

  // Editable title
  if (canEdit && S.editMode) {
    const te = document.getElementById('pgTitle');
    if (te) te.oninput = ()=>{ page.title=te.textContent; renderModuleList(c); };
  }
  attachEditable(page);
}

function togglePageComplete() {
  if (!S.user) { openModal('loginModal'); return; }
  const c = S.courses.find(x=>x.id===S.curCourseId);
  const wasDone = isPageDone(c.id, S.curPageKey);
  markPageDone(c.id, S.curPageKey, !wasDone);
  // update button
  const btn = document.getElementById('completeBtnMain');
  if (btn) {
    const isDone = !wasDone;
    btn.className = `complete-btn ${isDone?'done':''}`;
    btn.innerHTML = `<svg width="16" height="16" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="10" fill="${isDone?'var(--green)':'none'}" stroke="${isDone?'var(--green)':'var(--border2)'}" stroke-width="2"/>
      <path d="M8 12l3 3 5-5" stroke="${isDone?'#fff':'var(--text3)'}" stroke-width="2.5" fill="none" stroke-linecap="round"/>
    </svg>${isDone?'Completed':'Mark Complete'}`;
    showToast(isDone?'✓ Marked as complete!':'Marked incomplete','green');
  }
  // Update sidebar checkmarks and progress bar
  const pct = getCourseProgress(c);
  document.getElementById('sbProg').style.width = pct+'%';
  document.getElementById('sbPct').textContent = pct+'%';
  renderModuleList(c);
}

// ════════════════════════════════════════════════
//   BLOCKS
// ════════════════════════════════════════════════
function renderBlock(b,bi) {
  const tb=`<div class="btb-wrap"><button class="btb mov" onclick="moveBlock(${bi},-1)" title="Move up">↑</button><button class="btb mov" onclick="moveBlock(${bi},1)" title="Move down">↓</button><button class="btb del" onclick="deleteBlock(${bi})" title="Delete">✕</button></div>`;

  if (b.t==='lab-meta') return `<div class="block" data-bi="${bi}">${tb}<div class="lab-header-bar"><div class="lab-ico"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 3H5a2 2 0 00-2 2v4m6-6h10a2 2 0 012 2v4M9 3v18m0 0h10a2 2 0 002-2V9M9 21H5a2 2 0 01-2-2V9m0 0h18"/></svg></div><div class="lab-hdr-text"><h3>Hands-on Lab</h3><p>Complete all steps · Earn ${b.points||50} points</p></div></div><div class="lab-meta-grid"><div class="lab-mc"><div class="lmv">${b.duration||'30 min'}</div><div class="lmk">Duration</div></div><div class="lab-mc"><div class="lmv">${b.difficulty||'Beginner'}</div><div class="lmk">Difficulty</div></div><div class="lab-mc"><div class="lmv">${b.points||50}</div><div class="lmk">Points</div></div></div></div>`;

  if (b.t==='step') {
    const ck=`step_${S.curCourseId}_${S.curPageKey}_${b.n}`;
    const done=!!S.progress[ck];
    return `<div class="block" data-bi="${bi}">${tb}<div class="step-block"><div class="step-hdr"><div class="step-num-b">${b.n}</div><h4>${b.title}</h4>${S.user?`<button class="step-done-btn ${done?'s-done':'s-undone'}" onclick="toggleStep('${ck}',this)">${done?'✓ Done':'Mark done'}</button>`:''}</div><div class="step-body">${b.c}</div></div></div>`;
  }

  if (b.t==='video') {
    const em=ytEmbed(b.url);
    return `<div class="block" data-bi="${bi}">${tb}<div class="b-video"><div class="video-wrapper">${em?`<iframe src="${em}" allowfullscreen loading="lazy"></iframe>`:`<div class="video-ph"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="48" height="48"><polygon points="5 3 19 12 5 21 5 3"/></svg><span style="font-size:13px">Set a YouTube URL in edit mode</span></div>`}</div><div class="v-cap" id="vc-${bi}">${b.cap||''}</div></div></div>`;
  }
  if (b.t==='image') return `<div class="block" data-bi="${bi}">${tb}<div class="b-image">${b.url?`<img class="img-actual" src="${b.url}" alt="${b.cap||''}">`:`<div class="img-ph" onclick="openImgModal(${bi})"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="32" height="32"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg><span>Click to set image URL</span></div>`}<div class="i-cap">${b.cap||''}</div></div></div>`;
  if (b.t==='link') return `<div class="block" data-bi="${bi}">${tb}<a class="b-link-card" href="${b.url}" target="_blank"><div class="b-link-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></div><div><div class="blk-lt">${b.lt||b.url}</div><div class="blk-ld">${b.ld||''}</div></div><div class="blk-arr"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg></div></a></div>`;

  let inner='';
  if (b.t==='heading') inner=`<h2 class="b-h">${b.c}</h2>`;
  else if (b.t==='text') inner=`<div class="b-text"><p>${b.c}</p></div>`;
  else if (b.t==='note') inner=`<div class="callout note"><span class="c-ico">ℹ</span><div class="c-body">${b.c}</div></div>`;
  else if (b.t==='tip') inner=`<div class="callout tip"><span class="c-ico">✓</span><div class="c-body">${b.c}</div></div>`;
  else if (b.t==='warning') inner=`<div class="callout warning"><span class="c-ico">⚠</span><div class="c-body">${b.c}</div></div>`;
  else if (b.t==='danger') inner=`<div class="callout danger"><span class="c-ico">🚫</span><div class="c-body">${b.c}</div></div>`;
  else if (b.t==='code') inner=`<pre class="b-code">${esc(b.c)}</pre>`;
  else if (b.t==='card') inner=`<div class="b-card"><h4>${b.h||'Card'}</h4><p>${b.c}</p></div>`;
  return `<div class="block" data-bi="${bi}">${tb}${inner}</div>`;
}

function attachEditable(page) {
  if (!S.editMode) return;
  const con = document.getElementById('blocksContainer');
  page.blocks.forEach((b,bi)=>{
    const el=con?.querySelector(`[data-bi="${bi}"]`); if(!el) return;
    if (b.t==='text') { const pp=el.querySelector('.b-text p'); if(pp){pp.contentEditable='true';pp.oninput=()=>b.c=pp.innerHTML;} }
    else if (b.t==='heading') { const h=el.querySelector('.b-h'); if(h){h.contentEditable='true';h.oninput=()=>b.c=h.textContent;} }
    else if (['note','tip','warning','danger'].includes(b.t)) { const cb=el.querySelector('.c-body'); if(cb){cb.contentEditable='true';cb.oninput=()=>b.c=cb.innerHTML;} }
    else if (b.t==='code') { const pre=el.querySelector('pre'); if(pre){pre.contentEditable='true';pre.oninput=()=>b.c=pre.textContent;} }
    else if (b.t==='card') { const h4=el.querySelector('h4'),pp=el.querySelector('p'); if(h4){h4.contentEditable='true';h4.oninput=()=>b.h=h4.textContent;} if(pp){pp.contentEditable='true';pp.oninput=()=>b.c=pp.innerHTML;} }
    else if (b.t==='video') { const vc=el.querySelector('.v-cap'); if(vc){vc.contentEditable='true';vc.oninput=()=>b.cap=vc.textContent;} }
  });
}

function addBlock(type) {
  const page=getPage(); if(!page) return;
  const d={text:{t:'text',c:'Enter content here.'},heading:{t:'heading',c:'New Section'},note:{t:'note',c:'Note content.'},tip:{t:'tip',c:'Tip content.'},warning:{t:'warning',c:'Warning content.'},danger:{t:'danger',c:'Danger note.'},code:{t:'code',c:'# code here'},card:{t:'card',h:'Card Title',c:'Card description.'}};
  page.blocks.push(d[type]||{t:type,c:''});
  renderPageContent();
  showToast('Block added','cyan');
}
function deleteBlock(bi){const p=getPage();if(!p)return;p.blocks.splice(bi,1);renderPageContent()}
function moveBlock(bi,dir){const p=getPage();if(!p)return;const ni=bi+dir;if(ni<0||ni>=p.blocks.length)return;[p.blocks[bi],p.blocks[ni]]=[p.blocks[ni],p.blocks[bi]];renderPageContent()}

let _vBi=null,_iBi=null;
function commitVideo(){const url=document.getElementById('vb-url').value.trim();const cap=document.getElementById('vb-cap').value.trim();const pg=getPage();if(!pg)return;if(_vBi!==null){pg.blocks[_vBi].url=url;pg.blocks[_vBi].cap=cap;}else{pg.blocks.push({t:'video',url,cap});}closeModal('addVideoModal');renderPageContent();showToast('Video embedded','cyan');_vBi=null;}
function openImgModal(bi){_iBi=bi;openModal('addImageModal')}
function commitImage(){const url=document.getElementById('ib-url').value.trim();const cap=document.getElementById('ib-cap').value.trim();const pg=getPage();if(!pg)return;if(_iBi!==null){pg.blocks[_iBi].url=url;pg.blocks[_iBi].cap=cap;}else{pg.blocks.push({t:'image',url,cap});}closeModal('addImageModal');renderPageContent();showToast('Image added','cyan');_iBi=null;}
function commitLink(){const url=document.getElementById('lb-url').value.trim();const lt=document.getElementById('lb-title').value.trim();const ld=document.getElementById('lb-desc').value.trim();const pg=getPage();if(!pg)return;pg.blocks.push({t:'link',url,lt,ld});closeModal('addLinkModal');renderPageContent();showToast('Link added','cyan')}

function toggleStep(ck,btn) {
  if (!S.user) { openModal('loginModal'); return; }
  const wasDone = !!S.progress[ck];
  if (wasDone) delete S.progress[ck]; else S.progress[ck]=true;
  if (S.user) saveProgress(S.user.email, S.progress);
  btn.textContent = !wasDone?'✓ Done':'Mark done';
  btn.className = 'step-done-btn '+(!wasDone?'s-done':'s-undone');
  showToast(!wasDone?'Step done! ✓':'Unmarked','green');
}

function toggleEdit(on) {
  if (S.role==='student'||S.role==='guest') { showToast('Instructors and Admins only','amber'); return; }
  S.editMode=on;
  document.body.classList.toggle('edit-mode',on);
  renderPageContent();
}

// ════════════════════════════════════════════════
//   COURSE STRUCTURE
// ════════════════════════════════════════════════
function openAddPage(mi){S.addingToMod=mi;openModal('addPageModal')}
function addPage(){
  const c=S.courses.find(x=>x.id===S.curCourseId);if(!c)return;
  const title=document.getElementById('ap-title').value.trim();
  const type=document.getElementById('ap-type').value;
  const url=document.getElementById('ap-url').value.trim();
  const dur=document.getElementById('ap-dur').value.trim();
  if(!title)return;
  const mi=S.addingToMod||0;
  const defBlocks=type==='lab'
    ?[{t:'lab-meta',duration:dur||'30 min',difficulty:'Beginner',points:50},{t:'heading',c:'Objectives'},{t:'text',c:'Define objectives here.'}]
    :type==='video'
    ?[{t:'heading',c:title},{t:'video',url:url||'',cap:'Video caption'},{t:'text',c:'Notes.'}]
    :[{t:'heading',c:title},{t:'text',c:'Start writing here.'}];
  c.modules[mi].pages.push({title,type,dur,url,blocks:defBlocks});
  closeModal('addPageModal');
  S.curPageKey=`${mi}-${c.modules[mi].pages.length-1}`;
  renderCourseView();
  showToast(`"${title}" created`,'green');
}
function addModule(){
  const c=S.courses.find(x=>x.id===S.curCourseId);if(!c)return;
  const title=document.getElementById('nm-title').value.trim();if(!title)return;
  const cols=['#FF9900','#4285F4','#0078D4','#D83B01','#C8202A','#8B5CF6','#10B981','#F59E0B'];
  c.modules.push({title,col:cols[c.modules.length%cols.length],pages:[]});
  closeModal('addModuleModal');
  renderCourseView();
  showToast(`Module "${title}" added`,'green');
}

// ════════════════════════════════════════════════
//   MANAGER
// ════════════════════════════════════════════════
function renderManager(){renderMgrCourses();renderPermTable();renderRequestsTable()}
function renderMgrCourses(){
  const p=PROV;
  document.getElementById('mgrCoursesGrid').innerHTML=S.courses.map(c=>{
    const pv=p[c.provider]||p.Other;
    const totalPgs=c.modules.reduce((s,m)=>s+m.pages.length,0);
    return `<div class="mgr-card">
      <span style="font-family:'JetBrains Mono',monospace;font-size:11px;color:${pv.color};font-weight:700">${pv.short} · ${c.id}</span>
      <h4>${c.name}</h4>
      <p>${c.level} · ${c.modules.length} modules · ${totalPgs} pages</p>
      <div class="mgr-actions">
        <button class="mc-btn primary" onclick="openCourse('${c.id}');showView('course')">Open</button>
        <button class="mc-btn danger" onclick="if(confirm('Delete ${c.id}?')){S.courses=S.courses.filter(x=>x.id!=='${c.id}');renderManager();showToast('Course deleted','amber')}">Delete</button>
      </div>
    </div>`;
  }).join('');
}
function renderPermTable(){
  const rc={admin:'av-a',instructor:'av-i',student:'av-s'};
  document.getElementById('permTable').innerHTML=`<thead><tr><th>User</th><th>Email</th><th>Role</th><th>Joined</th><th>Change Role</th></tr></thead><tbody>${S.users.map((u,i)=>`<tr><td><div style="display:flex;align-items:center;gap:10px"><div class="u-av ${rc[u.role]||'av-s'}">${u.name.split(' ').map(w=>w[0]).join('').substring(0,2).toUpperCase()}</div>${u.name}</div></td><td style="color:var(--text3)">${u.email}</td><td><span style="font-size:11.5px;font-weight:700;padding:3px 9px;border-radius:20px;background:var(--bg3)">${u.role}</span></td><td style="color:var(--text3);font-size:12px">${u.joined}</td><td><select class="perm-sel" onchange="S.users[${i}].role=this.value;renderPermTable();showToast('Role updated','green')"><option ${u.role==='student'?'selected':''} value="student">Student</option><option ${u.role==='instructor'?'selected':''} value="instructor">Instructor</option><option ${u.role==='admin'?'selected':''} value="admin">Admin</option></select></td></tr>`).join('')}</tbody>`;
}
function renderRequestsTable(){
  const sc={pending:'req-pending',approved:'req-approved',rejected:'req-rejected'};
  document.getElementById('requestsTable').innerHTML=`<thead><tr><th>Applicant</th><th>Email</th><th>Certifications</th><th>Status</th><th>Actions</th></tr></thead><tbody>${S.instructorRequests.map((r,i)=>`<tr><td><strong>${r.name}</strong><br><span style="font-size:11.5px;color:var(--text3)">${r.linkedin}</span></td><td style="color:var(--text3);font-size:13px">${r.email}</td><td style="font-size:13px">${r.certs}</td><td><span class="req-badge ${sc[r.status]}">${r.status}</span></td><td><div style="display:flex;gap:6px">${r.status==='pending'?`<button onclick="S.instructorRequests[${i}].status='approved';renderRequestsTable();showToast('Approved ✓','green')" style="padding:4px 10px;border-radius:5px;background:rgba(16,185,129,0.1);color:var(--green);border:1px solid rgba(16,185,129,0.3);cursor:pointer;font-size:12px;font-weight:700">Approve</button><button onclick="S.instructorRequests[${i}].status='rejected';renderRequestsTable();showToast('Rejected','amber')" style="padding:4px 10px;border-radius:5px;background:rgba(244,63,94,0.1);color:var(--rose);border:1px solid rgba(244,63,94,0.3);cursor:pointer;font-size:12px;font-weight:700">Reject</button>`:'<span style="color:var(--text3);font-size:12px">—</span>'}</div></td></tr>`).join('')}</tbody>`;
}
function switchMgrTab(tab,btn){
  document.querySelectorAll('.m-tab').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  document.getElementById('mgrCourses').style.display=tab==='courses'?'':'none';
  document.getElementById('mgrUsers').style.display=tab==='users'?'':'none';
  document.getElementById('mgrRequests').style.display=tab==='requests'?'':'none';
}
function addCourse(){
  const id=document.getElementById('nc-id').value.trim().toUpperCase();
  const name=document.getElementById('nc-name').value.trim();
  const provider=document.getElementById('nc-provider').value;
  const level=document.getElementById('nc-level').value;
  const desc=document.getElementById('nc-desc').value.trim();
  const duration=document.getElementById('nc-dur').value.trim()||'0 hours';
  if(!id||!name)return;
  S.courses.push({id,name,provider,level,desc,duration,modules:[]});
  closeModal('addCourseModal');
  renderManager();
  showToast(`Course ${id} created`,'green');
}
function addUser(){
  const name=document.getElementById('au-name').value.trim();
  const email=document.getElementById('au-email').value.trim();
  const role=document.getElementById('au-role').value;
  if(!name||!email)return;
  S.users.push({id:Date.now(),name,email,role,joined:new Date().toISOString().split('T')[0]});
  closeModal('addUserModal');
  renderPermTable();
  showToast(`${name} added`,'green');
}

// ════════════════════════════════════════════════
//   UTILS
// ════════════════════════════════════════════════
function openModal(id){document.getElementById(id).classList.add('open')}
function closeModal(id){document.getElementById(id).classList.remove('open')}
document.querySelectorAll('.modal-overlay').forEach(o=>o.addEventListener('click',e=>{if(e.target===o)o.classList.remove('open')}));
let _t;
function showToast(msg,type='cyan'){const t=document.getElementById('toast');t.textContent=msg;t.className=`toast ${type} show`;clearTimeout(_t);_t=setTimeout(()=>t.classList.remove('show'),2600)}
function ytEmbed(url){if(!url)return'';const m=url.match(/(?:youtube\.com\/(?:watch\?v=|embed\/)|youtu\.be\/)([A-Za-z0-9_-]{11})/);return m?`https://www.youtube.com/embed/${m[1]}`:(url.includes('embed')?url:'')}
function esc(s){return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')}

// ════════════════════════════════════════════════
//   INIT
// ════════════════════════════════════════════════
initSession();
updateUI();
showView('home');
</script>
</body>
</html>